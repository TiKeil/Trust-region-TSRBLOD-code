VARIABLES: 
Coarse elements:        20 x 20
Fine elements:          1200 x 1200
high_c/low_c/min_c:     4.0/1.2/1.0
rhs/f_1/f_2:            10.0/4/8

Discretizing grid with diameter 1.18e-03

Information on the grids:
Rect-Grid on domain [0,1] x [0,1]
x0-intervals: 1200, x1-intervals: 1200
elements: 1440000, edges: 2882400, vertices: 1442401

Coarse FEM mesh:            20 x 20
Fine FEM mesh:              1200 x 1200
k:                          3
|log H|:                    2.65
number of fine dofs         1442401
Optimal parameter:  [2.55189365 3.84088781 3.29637928 4.         4.         3.05866626
 4.         4.         4.         4.         1.00739464 4.
 3.65484262 1.90122907 4.         3.93528075 3.53528147 1.19522632
 1.88423339 1.86380332 3.46739902 2.87854911 1.33143314 1.00158643
 1.18843325 1.02830015 1.08431931 1.06929789 1.2        1.2
 1.2        1.2       ]
Norm mu_d:  16.048194667388525
Optimal J FEM:  1.0
Optimal J LOD:  1.0000082533999917
FEM Error in J LOD:  8.253399991664523e-06

Starting parameter:  [2.25106601 3.16097348 1.00034312 1.90699772 1.44026767 1.27701578
 1.55878063 2.03668218 2.19030242 2.6164502  2.25758354 3.0556585
 1.61335675 3.63435231 1.08216278 3.01140253 2.25191441 2.67606949
 1.42116082 1.59430447 3.40223371 3.90478473 1.94027253 3.07696785
 1.17527783 1.17892133 1.01700884 1.00781096 1.03396608 1.1756285
 1.01966937 1.08422153]
Starting J FEM:  1.0507441622863822

Parameter space:  {diffusion: 24, low_diffusion: 8}

________________ FOM BFGS________________________

Starting projected BFGS method
Starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Step [2.25271919 3.16300476 1.00689729 1.91335266 1.44732462 1.28330021
 1.56311707 2.04053451 2.19442274 2.6201444  2.2587375  3.05900594
 1.61709659 3.63431209 1.08690843 3.01415437 2.25386315 2.67525303
 1.42310817 1.59605691 3.40327866 3.90473929 1.94013765 3.07536683
 1.17678109 1.18025897 1.01857586 1.00937312 1.03580714 1.17732753
 1.02195659 1.08644009], functional 1.0504058997638768 , FOC condition 0.018328853727027705
Step [2.48422254 3.44780784 1.92462929 2.80299707 2.43552099 2.16259296
 2.17199892 2.58118354 2.77246282 3.13811863 2.41846851 3.52793483
 2.1423025  3.62668263 1.75362517 3.39982189 2.52780283 2.55940851
 1.69578121 1.84125742 3.54939492 3.89715127 1.920535   2.84909658
 1.2        1.2        1.2        1.2        1.2        1.2
 1.2        1.2       ], functional 1.0206452854274428 , FOC condition 0.007708773142809736
Step [2.63354886 3.63187323 2.51746778 3.37752534 3.07397938 2.73006688
 2.56659296 2.93131438 3.14645226 3.47296032 2.51969794 3.83068437
 2.48252865 3.61964167 2.18589103 3.64891465 2.70548166 2.48304775
 1.87152015 1.999093   3.64328207 3.89086052 1.90706769 2.700934
 1.2        1.2        1.2        1.2        1.2        1.2
 1.2        1.2       ], functional 1.0122548783687695 , FOC condition 0.005185683650938984
Step [2.77956354 3.81220358 3.09842529 3.94039224 3.69973714 3.28570148
 2.95429427 3.27510245 3.51326912 3.80110765 2.61693684 4.
 2.81654023 3.61063636 2.61066895 3.89275734 2.88009218 2.40672421
 2.04311274 2.15300283 3.73461767 3.88324069 1.89302319 2.55384003
 1.2        1.1998556  1.19989684 1.19988181 1.2        1.2
 1.2        1.2       ], functional 1.0088193420344724 , FOC condition 0.004491547972680025
Step [2.83412413 3.87992266 3.31678878 4.         3.93503835 3.49411004
 3.10098671 3.40496379 3.65141657 3.92442811 2.65158924 3.99984315
 2.9426113  3.60519301 2.77141962 3.98413258 2.94615976 2.37657885
 2.10695405 2.21006596 3.76825736 3.87893683 1.88690595 2.49670829
 1.19972145 1.19840783 1.19754012 1.19745811 1.19980472 1.19980473
 1.1997957  1.19979616], functional 1.0084358039932153 , FOC condition 0.004558011584242508
Step [2.85829688 3.91028852 3.41491758 3.999857   4.         3.58729516
 3.16794799 3.46401147 3.71378783 3.97982204 2.66511788 3.99356207
 2.99982531 3.60052698 2.84482639 4.         2.976314   2.36145931
 2.13493039 2.23485458 3.78262426 3.8754468  1.88325082 2.46904707
 1.19745706 1.19556675 1.19320527 1.19303129 1.1966068  1.19748494
 1.19602502 1.19643074], functional 1.0083428246310089 , FOC condition 0.0046016055900148295
Step [2.88715006 3.94709085 3.53417237 3.97041311 3.99983076 3.69983341
 3.25089641 3.536814   3.79002292 4.         2.67847228 3.97507214
 3.07019919 3.59150052 2.93580146 3.99962746 3.0136592  2.34070684
 2.16785038 2.26368657 3.79894955 3.86885387 1.8774393  2.43242851
 1.19152351 1.18882568 1.18302535 1.18264669 1.1881121  1.19135125
 1.18599284 1.18748794], functional 1.0082260147872018 , FOC condition 0.004631503372063559
Step [2.91804857 3.98751657 3.66574889 3.88829252 3.91681156 3.82273078
 3.34522859 3.61900577 3.87491862 3.99977508 2.68768469 3.93682373
 3.14935643 3.57553858 3.0393395  3.96988287 3.05611618 2.31355541
 2.20224475 2.29318743 3.81493529 3.8573751  1.86857827 2.38665475
 1.17935437 1.17558977 1.16314708 1.16237862 1.17059585 1.17872801
 1.16529474 1.16904727], functional 1.0080658570528664 , FOC condition 0.004624486448715743
Step [2.94225909 4.         3.77635812 3.7320189  3.69614733 3.9236518
 3.42983439 3.69162155 3.94776593 3.94727688 2.68502191 3.87325399
 3.21875455 3.55080424 3.13234989 3.89195183 3.09417177 2.28270878
 2.22753051 2.31363707 3.82455922 3.8398035  1.85651455 2.33804935
 1.15863082 1.15365823 1.13035454 1.12895299 1.14067979 1.1571904
 1.12993448 1.1375523 ], functional 1.007835964594841 , FOC condition 0.004530781271655729
Step [2.94559289 3.99974797 3.80559286 3.55189407 3.39228236 3.94617047
 3.46141268 3.71693134 3.96959222 3.84980289 2.66624733 3.80643406
 3.24205913 3.52461209 3.16731787 3.78464062 3.10833663 2.26062002
 2.22791917 2.31149256 3.82048683 3.82140765 1.84531464 2.30761758
 1.13514878 1.1293573  1.09421596 1.09212489 1.10673254 1.13275898
 1.08980334 1.10181109], functional 1.0076489082611486 , FOC condition 0.00437288047206379
Step [2.92924943 3.9793614  3.74625432 3.49807546 3.26112288 3.88748255
 3.42610935 3.68466837 3.9333284  3.79493104 2.64791085 3.79087668
 3.21026369 3.51637595 3.1288001  3.73759302 3.09241514 2.26191761
 2.20747573 2.29227017 3.80809714 3.81579871 1.84302637 2.31445575
 1.1268845  1.12123288 1.08235788 1.08004522 1.09477535 1.12415327
 1.07566737 1.08922124], functional 1.007571465072342 , FOC condition 0.004275877380311829
Step [2.91043535 3.95719258 3.67483688 3.49719717 3.20561999 3.81801255
 3.38103859 3.64412428 3.88896568 3.76705713 2.63091792 3.7950597
 3.17061442 3.51197072 3.0795616  3.71586109 3.07210342 2.26737918
 2.18465012 2.27126536 3.7950607  3.81292018 1.84252675 2.32761951
 1.12254529 1.11726861 1.07685861 1.07444359 1.0885438  1.11965461
 1.0683072  1.08266061], functional 1.0075098925303188 , FOC condition 0.004207292522517393
Step [2.88841071 3.93173899 3.59373376 3.52832638 3.17376958 3.73823641
 3.33182156 3.5993852  3.83914472 3.7542281  2.60780532 3.81105964
 3.12666887 3.50278555 3.02593269 3.6990961  3.04991633 2.27060309
 2.15743068 2.24584533 3.77890351 3.80677291 1.84027862 2.33884082
 1.11523282 1.11043275 1.06750322 1.06490647 1.07814592 1.1121234
 1.05604062 1.07171688], functional 1.0074087796195537 , FOC condition 0.004129150807587712
Step [2.85125946 3.889353   3.4667079  3.63201546 3.15054957 3.60971406
 3.26267932 3.53458154 3.76336097 3.76644176 2.55615201 3.85485615
 3.06218632 3.47149852 2.95109812 3.67350933 3.01871833 2.26363204
 2.10951197 2.19966168 3.74807196 3.78546061 1.82993846 2.3413338
 1.09259631 1.08853239 1.03725499 1.03405757 1.04606428 1.08886805
 1.01820918 1.03795853], functional 1.0071505420350073 , FOC condition 0.0039831370943152755
Step [2.80684292 3.83966929 3.33804296 3.85877134 3.17464212 3.47039818
 3.21294604 3.48240658 3.69234845 3.85191095 2.46433633 3.94015334
 3.00798994 3.39662502 2.89870928 3.64302871 2.99620515 2.22586021
 2.04747764 2.13661644 3.70272635 3.73401781 1.80203911 2.30531536
 1.04120643 1.03775034 1.         1.         1.         1.03616117
 1.         1.        ], functional 1.0066090037317312 , FOC condition 0.003779887286710325
Step [2.74423344 3.77065924 3.229761   4.         3.22422871 3.31917844
 3.24660182 3.48858411 3.65396292 4.         2.24012078 4.
 3.0037187  3.17301322 2.94159678 3.55407922 3.01107129 2.07988
 1.94504244 2.02303526 3.61200026 3.57962787 1.71372133 2.13163008
 1.         1.         1.00006519 1.00005017 1.00021593 1.
 1.00023064 1.00023057], functional 1.0051325287511017 , FOC condition 0.003318119747460933
Step [2.5912766  3.60757945 3.13814065 4.         3.57571502 3.05661019
 3.57431801 3.69230058 3.70626286 3.99999957 1.46827628 4.
 3.16409436 2.34753741 3.32285706 3.29162586 3.1577548  1.50394065
 1.65967037 1.68743325 3.32726982 3.00907245 1.38223692 1.41669024
 1.000291   1.00013086 1.09938067 1.09523391 1.11549354 1.00031055
 1.08083655 1.10536975], functional 1.0017039027253436 , FOC condition 0.0023147739326260116
Step [2.59809989 3.62256103 3.30045098 4.         3.93565966 3.16608606
 3.7843698  3.8558315  3.83770623 4.         1.29777917 4.
 3.31349511 2.12903413 3.55920136 3.31444038 3.25238429 1.3290582
 1.64068938 1.64964073 3.28263804 2.85793514 1.29135911 1.18283178
 1.06544075 1.06417768 1.2        1.19710493 1.2        1.06657686
 1.1760497  1.2       ], functional 1.0008345593523311 , FOC condition 0.0016145723769913605
Step [2.64342132 3.67784945 3.50746189 4.         4.         3.35496542
 3.9427544  3.99176026 3.97435809 4.         1.29336385 4.
 3.4441061  2.08333689 3.73435205 3.35451678 3.32410979 1.27173237
 1.68935596 1.68924838 3.30192356 2.82628637 1.26952876 1.09255983
 1.11690005 1.11384105 1.2        1.2        1.2        1.11817535
 1.2        1.2       ], functional 1.0005539082295427 , FOC condition 0.0012037321943642594
Step [2.6577334  3.69685124 3.56906972 3.99999965 4.         3.41224377
 3.98751745 4.         4.         4.         1.29690674 4.
 3.48201833 2.07514407 3.78411917 3.39126236 3.34467564 1.25855769
 1.70607575 1.70359612 3.30990054 2.82095137 1.26545998 1.07059801
 1.14079588 1.1370525  1.1999255  1.19991051 1.2        1.14224038
 1.2        1.2       ], functional 1.0005153614911224 , FOC condition 0.0011261815063652774
Step [2.66497128 3.70984309 3.60503882 4.         3.99998155 3.44410315
 4.         3.99999635 4.         4.         1.29256804 4.
 3.50668999 2.06353406 3.81789721 3.45360919 3.3587633  1.24608464
 1.71468306 1.71034011 3.313164   2.81373109 1.26076595 1.0518159
 1.169114   1.16469553 1.2        1.2        1.2        1.1708501
 1.2        1.2       ], functional 1.0004800233098174 , FOC condition 0.0010738413088726966
Step [2.6652943  3.72202662 3.62605002 3.99997064 4.         3.45723388
 3.99999053 3.97628121 3.99999768 3.99999769 1.2675733  4.
 3.52951837 2.03271848 3.85356194 3.60306498 3.37389459 1.22192066
 1.7149957  1.70790695 3.30959986 2.79464408 1.24956668 1.01976764
 1.2        1.2        1.19987224 1.19985723 1.2        1.2
 1.19998868 1.19998873], functional 1.0004126470880497 , FOC condition 0.0010024684719566513
Step [2.65417885 3.73137014 3.60921211 4.         3.99996032 3.43129851
 3.95796108 3.90888202 3.97844669 4.         1.22533167 3.99998872
 3.53618468 1.99121014 3.87115419 3.88153799 3.3822564  1.19496926
 1.7039791  1.69443248 3.29927251 2.77035698 1.23622309 1.
 1.19995293 1.19979282 1.19818031 1.19814861 1.19998335 1.19998335
 1.19920158 1.19888622], functional 1.0003318026921266 , FOC condition 0.0009142166840658461
Step [2.64463702 3.72843144 3.57920247 3.99996572 3.99061313 3.39966216
 3.9280325  3.87946456 3.96588174 3.99999542 1.20885278 4.
 3.52428192 1.97974802 3.85856538 3.97231728 3.37764781 1.19066286
 1.69422881 1.68471166 3.29304978 2.76424481 1.23337184 1.00004993
 1.17867324 1.1776828  1.19108027 1.19125688 1.19412082 1.17879589
 1.1949863  1.19253421], functional 1.0003135131959369 , FOC condition 0.0008990157174068803
Step [2.6406403  3.72618844 3.55878697 3.99817119 3.9697153  3.38153554
 3.90875715 3.86947747 3.96189162 4.         1.21201812 3.99999024
 3.51164823 1.98760652 3.84077657 3.99017687 3.37081212 1.19883139
 1.69183654 1.68336954 3.29334778 2.77046926 1.23743496 1.01273134
 1.1564487  1.1544829  1.18075928 1.18120746 1.18510594 1.15662015
 1.18843188 1.18311398], functional 1.0003061798549027 , FOC condition 0.0008965699571576036
Step [2.64027647 3.72630118 3.55385515 3.99579297 3.95455499 3.37790824
 3.90493531 3.8739393  3.96623485 4.         1.21619232 3.99942279
 3.50796192 1.99341591 3.83471085 3.98187127 3.36866618 1.20364201
 1.69291718 1.68493508 3.295019   2.77489075 1.24014233 1.01897745
 1.14349468 1.14079758 1.17268647 1.17340454 1.17810397 1.14361155
 1.18403387 1.17585582], functional 1.000302984719787 , FOC condition 0.0008981970182661156
Step [2.64103134 3.72843296 3.55396577 3.99556399 3.94481773 3.3788288
 3.90587241 3.88680646 3.9767914  4.         1.22027271 3.99970169
 3.50792478 1.99834927 3.83333102 3.97048807 3.36867294 1.20729363
 1.6958876  1.68815724 3.29772129 2.77903738 1.24264057 1.02310118
 1.13078521 1.12709797 1.16308439 1.16427012 1.17002688 1.13077795
 1.18057543 1.1675454 ], functional 1.0002990881966305 , FOC condition 0.0008984584060069908
Step [2.64271942 3.73427042 3.55835134 3.99827448 3.94556174 3.3834347
 3.91076268 3.91429429 3.99862798 4.         1.22408692 4.
 3.51206963 2.00277603 3.83704873 3.96108451 3.37143739 1.21027253
 1.70191824 1.69419694 3.30246248 2.78387224 1.24558034 1.02572152
 1.11461138 1.10914355 1.14905335 1.15114883 1.15892572 1.11437727
 1.17867275 1.15610595], functional 1.000292383612389 , FOC condition 0.0008944453926043624
Step [2.64459736 3.7442595  3.56582307 4.         3.96777464 3.38992928
 3.91808685 3.95578039 4.         4.         1.22484386 4.
 3.52091776 2.00405481 3.84703563 3.96381536 3.37759909 1.2109001
 1.71046007 1.70234362 3.30869687 2.78793352 1.24816478 1.02489219
 1.10047263 1.09247495 1.13440773 1.13773174 1.14891491 1.09997746
 1.18160896 1.14551833], functional 1.000283129261228 , FOC condition 0.0008836774631962962
Step [2.64619335 3.76005861 3.57500834 3.99999096 4.         3.39665814
 3.92694084 4.         4.         4.         1.22146281 4.
 3.53509273 2.00177901 3.8639321  3.98280301 3.38794458 1.20920874
 1.7225369  1.71356724 3.31729407 2.79179507 1.25083739 1.02033636
 1.09170352 1.08016262 1.12063945 1.12550994 1.14272043 1.09093636
 1.1928274  1.13819392], functional 1.0002697717350502 , FOC condition 0.0008563012091475846
Step [2.64463842 3.78637256 3.57794798 3.99197575 3.99998398 3.39416239
 3.93709933 3.9999938  4.         4.         1.20704613 4.
 3.55617188 1.99200448 3.88959368 4.         3.40530236 1.20398155
 1.7406455  1.73007876 3.33044306 2.79605441 1.25441281 1.00945727
 1.087862   1.06988647 1.10746071 1.11471923 1.14488956 1.08684934
 1.2        1.13776928], functional 1.000241344531424 , FOC condition 0.0008019233821252571
Step [2.62091073 3.9334837  3.53752807 3.974028   4.         3.32319354
 3.97272272 3.931658   4.         4.         1.11125349 4.
 3.65389513 1.93696728 4.         3.99996527 3.49598198 1.18283097
 1.83929821 1.82081112 3.40592362 2.82754615 1.28058064 1.
 1.07205355 1.01384391 1.05194759 1.07386446 1.18587068 1.07022436
 1.2        1.16302998], functional 1.0001213299350624 , FOC condition 0.0005453773670540534
Step [2.60044253 3.9839199  3.48216448 3.99108739 3.99998463 3.25526057
 3.97374106 3.87991158 3.99999987 3.99999989 1.05930826 3.99999691
 3.67600458 1.90950586 4.         3.94851411 3.52516227 1.17570659
 1.87001165 1.84895213 3.4315944  2.83894462 1.2912163  1.00002164
 1.07509772 1.         1.04859869 1.07671102 1.2        1.07331991
 1.2        1.19510469], functional 1.000085588120395 , FOC condition 0.00045500947876196663
Step [2.5806088  4.         3.41744631 4.         4.         3.18441536
 3.95695134 3.85214445 3.98547629 4.         1.02462855 4.
 3.673716   1.89680399 4.         3.89476195 3.53540889 1.1783169
 1.88418587 1.86257429 3.44623789 2.85061208 1.30114291 1.01100046
 1.08385214 1.00007647 1.05887342 1.09103746 1.2        1.08237472
 1.2        1.2       ], functional 1.000063301135194 , FOC condition 0.0003935809638220128
Step [2.56498335 3.99983546 3.36305992 3.99999598 4.         3.12611093
 3.93797734 3.85463813 3.96087029 4.         1.0014687  4.
 3.67136735 1.89317302 4.         3.85917779 3.54370739 1.18567411
 1.89992796 1.87823135 3.46213759 2.86617975 1.31294645 1.02569943
 1.10497479 1.01473958 1.07202316 1.10767418 1.2        1.10365289
 1.2        1.2       ], functional 1.0000474035410527 , FOC condition 0.0003302267678276187
Step [2.55708826 3.97185381 3.33273148 3.99752757 4.         3.09615336
 3.91953981 3.89330679 3.93624953 4.         1.         4.
 3.65860235 1.89323237 4.         3.85410151 3.53854313 1.18989147
 1.89621208 1.87517333 3.46144938 2.86919782 1.31550958 1.03180146
 1.12970216 1.04163446 1.09052905 1.12649296 1.2        1.12840398
 1.2        1.2       ], functional 1.0000329545392688 , FOC condition 0.0002676978218928241
Step [2.5519409  3.93505559 3.3155798  3.99186856 4.         3.07894396
 3.90512137 3.96498464 3.91843314 4.         1.00002156 4.
 3.64807553 1.88757005 4.         3.88031317 3.53270695 1.18760322
 1.88654723 1.86576539 3.45475081 2.86388861 1.3125812  1.02723637
 1.15263611 1.06950219 1.10477295 1.14018544 1.2        1.15102779
 1.2        1.2       ], functional 1.0000221987431868 , FOC condition 0.00021771030926917537
Step [2.5529789  3.92385819 3.32007747 3.98963909 4.         3.083417
 3.90472753 4.         3.92406869 4.         1.00361816 4.
 3.64883449 1.88629946 4.         3.90566487 3.53245566 1.18586475
 1.88487968 1.86399587 3.4530833  2.86162995 1.31108299 1.02286539
 1.15725323 1.07625233 1.10288654 1.13798857 1.2        1.15523769
 1.2        1.2       ], functional 1.0000188058961714 , FOC condition 0.0001994067135399197
Step [2.55405411 3.91882497 3.32615925 3.99005681 4.         3.08849649
 3.90890201 4.         3.9436221  4.         1.00436273 4.
 3.65403558 1.88359402 4.         3.9299613  3.53567841 1.18329906
 1.88701223 1.86572198 3.4541655  2.86042836 1.31039948 1.01729189
 1.15738469 1.07720574 1.09521228 1.13045552 1.2        1.15476376
 1.19999788 1.19999789], functional 1.0000157931258744 , FOC condition 0.00018202646364814376
Step [2.55319709 3.90128634 3.32752193 3.99332282 3.99999922 3.08727194
 3.91840382 4.         3.991929   4.         1.00341979 4.
 3.66326837 1.87782951 4.         3.95530001 3.54316476 1.17980518
 1.89369421 1.87162966 3.45896598 2.86090363 1.31122651 1.00733126
 1.15925223 1.08021096 1.07902903 1.11521701 1.19999972 1.15515153
 1.19917197 1.19738832], functional 1.000011482968787 , FOC condition 0.00015522587970848343
Step [2.55090366 3.88458187 3.32003624 3.99753173 4.         3.07885724
 3.92262349 4.         4.         3.99999691 1.00365573 3.99999902
 3.66453261 1.87671987 3.99999902 3.94919618 3.545606   1.1805084
 1.89716709 1.87497703 3.46220255 2.86346164 1.31325345 1.00463933
 1.16145649 1.08315588 1.07170506 1.10857781 1.19806414 1.15650872
 1.19811125 1.19363048], functional 1.0000094427833188 , FOC condition 0.0001401255137098834
Step [2.5478914  3.84563781 3.30807987 4.         3.99999867 3.06644175
 3.93359887 4.         3.99999745 4.         1.01009269 4.
 3.66434567 1.87862425 3.99736642 3.92550296 3.54762658 1.18406265
 1.90219376 1.88010501 3.46730124 2.86917769 1.31739303 1.00058178
 1.16587314 1.09017515 1.05804902 1.09576084 1.19440383 1.15923055
 1.19668516 1.18611363], functional 1.0000072958808208 , FOC condition 0.00012319729902395855
Step [2.54849012 3.8397108  3.30953925 4.         4.         3.06820957
 3.93698797 4.         4.         4.         1.01303828 4.
 3.66432659 1.87985476 3.995835   3.92332914 3.54732003 1.18467225
 1.90227096 1.88024625 3.46739466 2.86963275 1.31762952 1.
 1.16603395 1.09100302 1.05625414 1.09381565 1.19513614 1.15917389
 1.19758603 1.18642503], functional 1.0000071334375806 , FOC condition 0.00012184269651464585
Step [2.54943824 3.8313792  3.31253305 4.         4.         3.07143506
 3.94403399 4.         3.99999999 3.99999999 1.01669135 4.
 3.66488941 1.88062972 3.9933177  3.92286153 3.54718587 1.18469439
 1.90207086 1.88005743 3.46717444 2.86947335 1.31749291 1.00000432
 1.16551889 1.0912215  1.05415341 1.09133977 1.19824416 1.15840445
 1.2        1.18916752], functional 1.0000068596234644 , FOC condition 0.00011933288407260957
Step [2.54981085 3.82620343 3.3139043  3.99999995 4.         3.0727781
 3.95098642 4.         3.99737184 4.         1.01842897 4.
 3.66547531 1.88053553 3.99085687 3.92456354 3.54736203 1.1843727
 1.90195768 1.87990963 3.4670911  2.86919305 1.31737555 1.00138848
 1.16390687 1.0895381  1.05360291 1.09038379 1.2        1.15673563
 1.2        1.19389727], functional 1.0000065710136374 , FOC condition 0.00011665727501192937
Step [2.54966329 3.82329489 3.31409345 4.         4.         3.07250176
 3.96228534 4.         3.99111498 3.99999995 1.01838144 4.
 3.66685812 1.87920191 3.98756629 3.92960921 3.54837965 1.18340067
 1.90230801 1.88012052 3.46745403 2.86877112 1.31734318 1.00565633
 1.16053009 1.0847754  1.05538359 1.09148483 1.2        1.15357385
 1.2        1.2       ], functional 1.0000061265123217 , FOC condition 0.00011249700170888191
Step [2.54890706 3.82608864 3.3125237  4.         4.         3.07020313
 3.97103089 4.         3.98656148 4.         1.01577366 4.
 3.66831539 1.87711725 3.98594544 3.9345663  3.54980116 1.18222746
 1.90301527 1.88064557 3.46814095 2.86843522 1.31743102 1.010705
 1.15836718 1.08044581 1.05992531 1.09544115 1.2        1.15187624
 1.2        1.2       ], functional 1.0000057955816595 , FOC condition 0.0001093713084081737
Step [2.54801333 3.83067766 3.31029415 4.         4.         3.06734119
 3.97693472 4.         3.98609705 4.         1.01266678 4.
 3.66918648 1.87523488 3.98526316 3.93704519 3.5508702  1.18127897
 1.90347434 1.880963   3.46865794 2.868157   1.31752244 1.01517805
 1.15807609 1.07811993 1.06562535 1.10062631 1.2        1.15210542
 1.2        1.2       ], functional 1.0000055842717475 , FOC condition 0.00010758627246955019
Step [2.54728903 3.83323778 3.30795244 3.9999998  3.99999977 3.06477461
 3.97928487 4.         3.98933343 4.         1.01087473 4.
 3.66883208 1.87446106 3.98486477 3.93625876 3.55095664 1.1810572
 1.9033016  1.88076876 3.46871713 2.8680949  1.31763859 1.01772472
 1.15862375 1.07756257 1.06953142 1.1041714  1.2        1.1529979
 1.19999962 1.19999962], functional 1.0000054498582143 , FOC condition 0.00010669490497106177
Step [2.54655253 3.83439428 3.30487457 4.         3.9999125  3.06180293
 3.980646   4.         3.99618411 3.99999963 1.01005479 3.99999998
 3.66725766 1.87460785 3.98429084 3.9331397  3.55014301 1.18150276
 1.90249137 1.88004719 3.46841601 2.86829061 1.31788631 1.02002992
 1.15938458 1.07749674 1.07299475 1.10714882 1.2        1.15410314
 1.19989834 1.19904393], functional 1.000005296325893 , FOC condition 0.00010559288868126379
Step [2.54626482 3.8334465  3.30280481 3.99999948 3.99979126 3.06016413
 3.98141003 4.         4.         4.         1.0109274  4.
 3.66521735 1.87576781 3.98399557 3.92958255 3.54875198 1.18245459
 1.90136825 1.87908887 3.46787451 2.86867313 1.31817062 1.02123576
 1.15979945 1.07759803 1.07431388 1.10794259 1.2        1.15474916
 1.19976429 1.19743787], functional 1.0000051570675057 , FOC condition 0.00010410179165444688
Step [2.54625798 3.83079963 3.30009174 3.99990931 3.99969715 3.05861255
 3.98392526 4.         3.99999927 3.99999927 1.01427604 4.
 3.66087654 1.87903249 3.98477869 3.92374519 3.54544653 1.18471777
 1.89871262 1.87682504 3.46651565 2.86951004 1.31875044 1.0225254
 1.16055874 1.07770724 1.07503173 1.10721212 1.2        1.15603579
 1.19948113 1.19305607], functional 1.0000048209485013 , FOC condition 0.00010010223461840501
Step [2.54688365 3.82909015 3.29767786 3.99955925 4.         3.05815855
 3.99097965 4.         4.         3.99987388 1.02041493 4.
 3.65441408 1.88468933 3.9894497  3.91920515 3.54010117 1.18824645
 1.89421046 1.87294762 3.46423287 2.87072574 1.31967217 1.02279356
 1.16263608 1.0777298  1.07436783 1.10329776 1.2        1.15930818
 1.19905753 1.18447249], functional 1.000004238057083 , FOC condition 9.360528589033461e-05
Converged: FOC = 9.360528589033461e-05
relative differences mu 0.001249953048554912 and J 5.828886081677853e-07
Computing only the initial FOC

________________ FOM BFGS________________________


FEM solves:   163
RB solves:    0

outer iterations:      52
total walltime:        6411.71s
mu_error:  0.09075702855975167

_________________TR NCD BFGS_____________________

Starting with two bases. Primal and dual have length 1 and 1
building simple coercive primal reductor...
building simple coercive dual reductor...
starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Starting value of the cost rom: 1.0507441622865274
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
boundary criterium of the TR satisfied, so stopping the sub-problem solver
sub-problem took 3.0244087306782603
enriching to check the sufficient decrease condition
enriching for mu: {diffusion: [2.5694703963365138, 3.754234146274389, 3.062421961205016, 3.9999752352163616, 2.453825256255445, 2.993290752131169, 3.4814339721535354, 3.6123549431782047, 3.675101981634627, 3.38340981507742, 1.5325915616673462, 3.560291816227333, 3.181784556595548, 2.4653901687267483, 3.297634633829704, 3.5083769231167383, 3.180083753585138, 1.5997931099928069, 1.7872896857795844, 1.8200917860320982, 3.4561507166088816, 3.167227388880827, 1.479837345143856, 1.5532173154159596], low_diffusion: [1.0000133798943873, 1.0, 1.0000002245891002, 1.0, 1.0000144102155821, 1.000014411605721, 1.0, 1.0]}
building simple coercive dual reductor...
Enrichment completed... length of Bases are 2 and 2
... enrichment took 170.89545s ...Total enrichment time is 170.89547s
estimate is: [5.88310174e-08]
k: 0 - j 20 - Cost Functional: 1.003768300116072 - mu: {diffusion: [2.5694703963365138, 3.754234146274389, 3.062421961205016, 3.9999752352163616, 2.453825256255445, 2.993290752131169, 3.4814339721535354, 3.6123549431782047, 3.675101981634627, 3.38340981507742, 1.5325915616673462, 3.560291816227333, 3.181784556595548, 2.4653901687267483, 3.297634633829704, 3.5083769231167383, 3.180083753585138, 1.5997931099928069, 1.7872896857795844, 1.8200917860320982, 3.4561507166088816, 3.167227388880827, 1.479837345143856, 1.5532173154159596], low_diffusion: [1.0000133798943873, 1.0, 1.0000002245891002, 1.0, 1.0000144102155821, 1.000014411605721, 1.0, 1.0]}
First order critical condition: 0.0035332316827722332
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 3.284747298658407e-07, mu_diff = 1.824787117772863e-13, J_diff = 1.110248519463784e-16 
relative differences mu 1.824787117772863e-13 and J 1.110248519463784e-16
sub-problem took 10.545344157144427
enriching to check the sufficient decrease condition
enriching for mu: {diffusion: [2.5347727699473364, 3.8237907319544133, 3.302053838617202, 4.0, 4.0, 3.078697661248766, 4.0, 4.0, 3.981523349936151, 3.9815044934376287, 1.0, 3.9857702649099234, 3.6049476983089823, 1.8515073453111843, 3.9681605401737565, 3.9032264773144947, 3.4731299736864014, 1.1331490990431055, 1.8021493014149108, 1.7818455222202871, 3.3836594246574507, 2.794620298628324, 1.235851302908705, 1.0], low_diffusion: [1.2, 1.039852804667959, 1.0974958106494845, 1.0822202171009456, 1.2, 1.2, 1.2, 1.2]}
building simple coercive dual reductor...
Enrichment completed... length of Bases are 3 and 3
... enrichment took 234.96830s ...Total enrichment time is 405.86379s
estimate is: [8.12770246e-08]
k: 1 - j 70 - Cost Functional: 1.0000517272768488 - mu: {diffusion: [2.5347727699473364, 3.8237907319544133, 3.302053838617202, 4.0, 4.0, 3.078697661248766, 4.0, 4.0, 3.981523349936151, 3.9815044934376287, 1.0, 3.9857702649099234, 3.6049476983089823, 1.8515073453111843, 3.9681605401737565, 3.9032264773144947, 3.4731299736864014, 1.1331490990431055, 1.8021493014149108, 1.7818455222202871, 3.3836594246574507, 2.794620298628324, 1.235851302908705, 1.0], low_diffusion: [1.2, 1.039852804667959, 1.0974958106494845, 1.0822202171009456, 1.2, 1.2, 1.2, 1.2]}
First order critical condition: 0.00047566820687630287
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 4.309624441174288e-08, mu_diff = 2.9148144401296333e-12, J_diff = 0.0 
relative differences mu 2.9148144401296333e-12 and J 0.0
sub-problem took 7.9403494913131
enriching to check the sufficient decrease condition
enriching for mu: {diffusion: [2.5504175126435045, 3.8394142423476936, 3.2940210120174394, 3.9976475722883302, 4.0, 3.0587995673616377, 3.9997695885061453, 3.9997672174479253, 3.9997320576620847, 3.9997373570927772, 1.0046504892226453, 3.9972837669436534, 3.6545613127664867, 1.9009194523944934, 4.0, 3.935844413975088, 3.5360156294609077, 1.195945442879924, 1.8874667472880284, 1.86703140737185, 3.4677421056420275, 2.878885718622044, 1.3279067533952855, 1.0], low_diffusion: [1.1868108818858605, 1.02664884043198, 1.080494296147277, 1.0654763391651179, 1.2, 1.2, 1.2, 1.2]}
building simple coercive dual reductor...
Enrichment completed... length of Bases are 4 and 4
... enrichment took 257.64167s ...Total enrichment time is 663.50547s
estimate is: [9.40439439e-08]
k: 2 - j 52 - Cost Functional: 1.000000072854634 - mu: {diffusion: [2.5504175126435045, 3.8394142423476936, 3.2940210120174394, 3.9976475722883302, 4.0, 3.0587995673616377, 3.9997695885061453, 3.9997672174479253, 3.9997320576620847, 3.9997373570927772, 1.0046504892226453, 3.9972837669436534, 3.6545613127664867, 1.9009194523944934, 4.0, 3.935844413975088, 3.5360156294609077, 1.195945442879924, 1.8874667472880284, 1.86703140737185, 3.4677421056420275, 2.878885718622044, 1.3279067533952855, 1.0], low_diffusion: [1.1868108818858605, 1.02664884043198, 1.080494296147277, 1.0654763391651179, 1.2, 1.2, 1.2, 1.2]}
enlarging the TR radius to 0.2
First order critical condition: 1.5098969551861016e-05
******************************* 


Stopping criteria fulfilled: FOC condition: 1.5098969551861016e-05
Sub-problems took 21.51013s
Computing only the initial FOC

_________________TR NCD BFGS_____________________

mu_error: 1.01e-02

FEM solves:   10
RB solves:    1067

outer iterations:      3
total walltime:        862.68s
Outer iterations:      841.17s
Inner iterations:      21.51s
Speedup:               7.43

_________________Relaxed TR NCD BFGS_____________________

Starting with two bases. Primal and dual have length 1 and 1
building simple coercive primal reductor...
building simple coercive dual reductor...
starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Starting value of the cost: 1.0507441622865274
******************************* 

Relaxing parameter: 1e+10
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.1749077293056403e-05, mu_diff = 1.7054258069255576e-15, J_diff = 0.0 
relative differences mu 1.7054258069255576e-15 and J 0.0
sub-problem took 10.62719181086868
starting enrichment
enriching for mu: {diffusion: [2.404322510277692, 3.693837247621618, 3.009292602617549, 3.714543705849499, 3.708599063172599, 2.764087423645781, 3.8209306181708174, 3.8212460953618135, 3.743300345802979, 3.7505014646003074, 1.0, 3.745384891902852, 3.3875342198895413, 1.631521291042057, 3.723415949850948, 3.657033048296222, 3.3488748388761906, 1.0066663079053928, 1.5460803373868484, 1.5259051243485862, 3.214217855979241, 2.6240166545472468, 1.1587229036985083, 1.0], low_diffusion: [1.0741882137899172, 1.0, 1.0, 1.0, 1.080845751472627, 1.079427242427056, 1.051279132365034, 1.051273839533166]}
building simple coercive dual reductor...
Enrichment completed... length of Bases are 2 and 2
... enrichment took 169.17118s ...Total enrichment time is 169.17120s
estimate is: [8.13434984e-08]
k: 0 - j 70 - Cost Functional: 1.003639618805024 - mu: {diffusion: [2.404322510277692, 3.693837247621618, 3.009292602617549, 3.714543705849499, 3.708599063172599, 2.764087423645781, 3.8209306181708174, 3.8212460953618135, 3.743300345802979, 3.7505014646003074, 1.0, 3.745384891902852, 3.3875342198895413, 1.631521291042057, 3.723415949850948, 3.657033048296222, 3.3488748388761906, 1.0066663079053928, 1.5460803373868484, 1.5259051243485862, 3.214217855979241, 2.6240166545472468, 1.1587229036985083, 1.0], low_diffusion: [1.0741882137899172, 1.0, 1.0, 1.0, 1.080845751472627, 1.079427242427056, 1.051279132365034, 1.051273839533166]}
TR criterion: [0.28936123]
strong sufficient decrease condition fulfilled
First order critical condition: 0.00355430679184122
******************************* 

Relaxing parameter: 1e+09
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 8.293096943014662e-09, mu_diff = 1.3416002902788418e-06, J_diff = 1.6941828605773578e-13 
relative differences mu 1.3416002902788418e-06 and J 1.6941828605773578e-13
sub-problem took 12.51565158367157
starting enrichment
enriching for mu: {diffusion: [2.5486091591725786, 3.8376076860099855, 3.291567689330755, 3.995174843096177, 3.9946454918882583, 3.0533000228267784, 3.9975808703292146, 3.9975852264878897, 3.9977299976129093, 3.997729113391073, 1.0015810740660902, 3.994204741140626, 3.6540127312287787, 1.9003727341175103, 3.9985398192561403, 3.933796040893987, 3.5342910049284204, 1.1942243902268816, 1.8873723401685762, 1.8669408818837692, 3.4668245389477828, 2.877965340659516, 1.3247611807057218, 1.0], low_diffusion: [1.1859590943607783, 1.0258222058518776, 1.082873339609092, 1.067855649653404, 1.2, 1.2, 1.2, 1.2]}
building simple coercive dual reductor...
Enrichment completed... length of Bases are 3 and 3
... enrichment took 235.83758s ...Total enrichment time is 405.00880s
estimate is: [7.97370017e-08]
k: 1 - j 85 - Cost Functional: 1.0000103147073145 - mu: {diffusion: [2.5486091591725786, 3.8376076860099855, 3.291567689330755, 3.995174843096177, 3.9946454918882583, 3.0533000228267784, 3.9975808703292146, 3.9975852264878897, 3.9977299976129093, 3.997729113391073, 1.0015810740660902, 3.994204741140626, 3.6540127312287787, 1.9003727341175103, 3.9985398192561403, 3.933796040893987, 3.5342910049284204, 1.1942243902268816, 1.8873723401685762, 1.8669408818837692, 3.4668245389477828, 2.877965340659516, 1.3247611807057218, 1.0], low_diffusion: [1.1859590943607783, 1.0258222058518776, 1.082873339609092, 1.067855649653404, 1.2, 1.2, 1.2, 1.2]}
TR criterion: [0.00119241]
strong sufficient decrease condition fulfilled
First order critical condition: 3.0048847176034132e-05
******************************* 


Stopping criteria fulfilled: FOC condition: 3.0048847176034132e-05
Sub-problems took 23.14286s
Computing only the initial FOC

_________________Relaxed TR NCD BFGS_____________________

mu_error: 1.75e-02

FEM solves:   8
RB solves:    1082

outer iterations:      2
total walltime:        565.38s
Outer iterations:      542.24s
Inner iterations:      23.14s
Speedup:               11.34

_________________Relaxed TR NCD BFGS without estimation_____________________

Starting with two bases. Primal and dual have length 1 and 1
building non assembled for primal reductor...
building non assembled dual reductor...
starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Starting value of the cost: 1.0507441622865274
******************************* 

Relaxing parameter: 1e+10
skipping estimations entirely
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.1749077293056403e-05, mu_diff = 1.7054258069255576e-15, J_diff = 0.0 
relative differences mu 1.7054258069255576e-15 and J 0.0
sub-problem took 9.997771710157394
starting enrichment
enriching for mu: {diffusion: [2.404322510277692, 3.693837247621618, 3.009292602617549, 3.714543705849499, 3.708599063172599, 2.764087423645781, 3.8209306181708174, 3.8212460953618135, 3.743300345802979, 3.7505014646003074, 1.0, 3.745384891902852, 3.3875342198895413, 1.631521291042057, 3.723415949850948, 3.657033048296222, 3.3488748388761906, 1.0066663079053928, 1.5460803373868484, 1.5259051243485862, 3.214217855979241, 2.6240166545472468, 1.1587229036985083, 1.0], low_diffusion: [1.0741882137899172, 1.0, 1.0, 1.0, 1.080845751472627, 1.079427242427056, 1.051279132365034, 1.051273839533166]}
building non assembled dual reductor...
Enrichment completed... length of Bases are 2 and 2
... enrichment took 87.42754s ...Total enrichment time is 87.42756s
k: 0 - j 70 - Cost Functional: 1.003639618805024 - mu: {diffusion: [2.404322510277692, 3.693837247621618, 3.009292602617549, 3.714543705849499, 3.708599063172599, 2.764087423645781, 3.8209306181708174, 3.8212460953618135, 3.743300345802979, 3.7505014646003074, 1.0, 3.745384891902852, 3.3875342198895413, 1.631521291042057, 3.723415949850948, 3.657033048296222, 3.3488748388761906, 1.0066663079053928, 1.5460803373868484, 1.5259051243485862, 3.214217855979241, 2.6240166545472468, 1.1587229036985083, 1.0], low_diffusion: [1.0741882137899172, 1.0, 1.0, 1.0, 1.080845751472627, 1.079427242427056, 1.051279132365034, 1.051273839533166]}
TR criterion: inf
strong sufficient decrease condition fulfilled
First order critical condition: 0.00355430679184122
******************************* 

Relaxing parameter: 1e+09
skipping estimations entirely
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 8.293096943014662e-09, mu_diff = 1.3416002902788418e-06, J_diff = 1.6941828605773578e-13 
relative differences mu 1.3416002902788418e-06 and J 1.6941828605773578e-13
sub-problem took 12.095628535374999
starting enrichment
enriching for mu: {diffusion: [2.5486091591725786, 3.8376076860099855, 3.291567689330755, 3.995174843096177, 3.9946454918882583, 3.0533000228267784, 3.9975808703292146, 3.9975852264878897, 3.9977299976129093, 3.997729113391073, 1.0015810740660902, 3.994204741140626, 3.6540127312287787, 1.9003727341175103, 3.9985398192561403, 3.933796040893987, 3.5342910049284204, 1.1942243902268816, 1.8873723401685762, 1.8669408818837692, 3.4668245389477828, 2.877965340659516, 1.3247611807057218, 1.0], low_diffusion: [1.1859590943607783, 1.0258222058518776, 1.082873339609092, 1.067855649653404, 1.2, 1.2, 1.2, 1.2]}
building non assembled dual reductor...
Enrichment completed... length of Bases are 3 and 3
... enrichment took 93.82087s ...Total enrichment time is 181.24844s
k: 1 - j 85 - Cost Functional: 1.0000103147073145 - mu: {diffusion: [2.5486091591725786, 3.8376076860099855, 3.291567689330755, 3.995174843096177, 3.9946454918882583, 3.0533000228267784, 3.9975808703292146, 3.9975852264878897, 3.9977299976129093, 3.997729113391073, 1.0015810740660902, 3.994204741140626, 3.6540127312287787, 1.9003727341175103, 3.9985398192561403, 3.933796040893987, 3.5342910049284204, 1.1942243902268816, 1.8873723401685762, 1.8669408818837692, 3.4668245389477828, 2.877965340659516, 1.3247611807057218, 1.0], low_diffusion: [1.1859590943607783, 1.0258222058518776, 1.082873339609092, 1.067855649653404, 1.2, 1.2, 1.2, 1.2]}
TR criterion: inf
strong sufficient decrease condition fulfilled
First order critical condition: 3.0048847176034132e-05
******************************* 


Stopping criteria fulfilled: FOC condition: 3.0048847176034132e-05
Sub-problems took 22.09342s
Computing only the initial FOC

_________________Relaxed TR NCD BFGS without estimation_____________________

mu_error: 1.75e-02

FEM solves:   8
RB solves:    696

outer iterations:      2
total walltime:        289.98s
Outer iterations:      267.89s
Inner iterations:      22.09s
Speedup:               22.11

________________FOM LOD BFGS_____________________

Starting projected BFGS method
Starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Step [2.25275525 3.1630415  1.00699977 1.91345787 1.44743976 1.28341427
 1.56316457 2.04058266 2.19448587 2.62020765 2.2588102  3.05907969
 1.61715594 3.63437266 1.08697064 3.01421841 2.25389293 2.67528307
 1.42316572 1.59611464 3.40332885 3.90478991 1.94016019 3.07538966
 1.17680181 1.18028013 1.01858425 1.0093808  1.03584574 1.17736648
 1.0219918  1.08647492], functional 1.05116146273709 , FOC condition 0.018625621772413573
Step [2.48551193 3.44834053 1.92410405 2.80329685 2.43561205 2.16427228
 2.16884019 2.57920329 2.77197258 3.13860228 2.42596726 3.53064593
 2.14214347 3.63519128 1.75159984 3.40253256 2.52756603 2.56542441
 1.69941122 1.8453494  3.55402255 3.90429028 1.92397704 2.85587465
 1.2        1.2        1.2        1.2        1.2        1.2
 1.2        1.2       ], functional 1.0209219309572612 , FOC condition 0.007814211879420207
Step [2.63563066 3.63270506 2.51645862 3.3778728  3.07396433 2.73267504
 2.56131674 2.92798196 3.14556679 3.4736819  2.53197941 3.83506255
 2.4821957  3.63361173 2.18247321 3.65330995 2.70505896 2.4929442
 1.87744997 2.00578491 3.6508603  3.90258284 1.91272667 2.71209824
 1.2        1.2        1.2        1.2        1.2        1.2
 1.2        1.2       ], functional 1.01240351661958 , FOC condition 0.0052307237728893225
Step [2.78299395 3.81403152 3.09919236 3.94296781 3.70204055 3.29137482
 2.94843999 3.2717743  3.51342271 3.80334122 2.63430351 4.
 2.81733773 3.62995019 2.60753353 3.89975993 2.88016947 2.420148
 2.05198233 2.16286114 3.74545748 3.89944689 1.900816   2.56875593
 1.2        1.19987843 1.19991891 1.19990386 1.2        1.2
 1.2        1.2       ], functional 1.0088908691043017 , FOC condition 0.004491831030174655
Step [2.83857459 3.8827569  3.32024749 4.         3.94039231 3.5028719
 3.09626576 3.40283576 3.6532439  3.92837932 2.6712184  3.99986117
 2.94500521 3.62649918 2.76987576 3.99297405 2.94704015 2.39107482
 2.11754261 2.2216672  3.78065283 3.8968154  1.89546311 2.51253576
 1.19974731 1.19850753 1.1976959  1.19761655 1.19982787 1.19982786
 1.19982349 1.19982403], functional 1.0084948168428487 , FOC condition 0.004552499387481516
Step [2.86279627 3.91306728 3.41794497 3.99987203 4.         3.59587268
 3.16263954 3.46145055 3.71533332 3.98362127 2.68549545 3.99394905
 3.00199336 3.62276161 2.84279543 4.         2.97706353 2.37666009
 2.14581614 2.24681404 3.79546221 3.8941019  1.89219968 2.48571108
 1.19767696 1.19588054 1.19369759 1.19353126 1.19687712 1.19769956
 1.1963633  1.196744  ], functional 1.008398900438532 , FOC condition 0.0045929439469091764
Step [2.89137113 3.9493683  3.53526041 3.97247219 3.99984561 3.70684814
 3.24388778 3.53286208 3.79032485 4.         2.69961232 3.97688697
 3.07125971 3.61498348 2.93209812 3.99964344 3.01381009 2.35702245
 2.1787223  2.27575535 3.81213661 3.88853901 1.886947   2.45056161
 1.19232247 1.18974025 1.1844474  1.18409016 1.18913983 1.19214335
 1.18727512 1.18866365], functional 1.0082874426331032 , FOC condition 0.004623276727424618
Step [2.92036669 3.98716684 3.65794949 3.89867835 3.92434927 3.82168615
 3.33155287 3.60933425 3.86951174 3.99978894 2.70910344 3.94316559
 3.14515778 3.60112007 3.02852756 3.97300949 3.05345161 2.33242955
 2.21131945 2.30383952 3.82764646 3.87870922 1.87913087 2.40868349
 1.18179006 1.17819537 1.16715084 1.16644527 1.17383451 1.1811744
 1.16928696 1.17267902], functional 1.008142682584523 , FOC condition 0.00462001918145491
Step [2.94482273 4.         3.76872303 3.75049371 3.71473407 3.9230021
 3.41593593 3.68185371 3.94248545 3.9522349  2.70744447 3.88393798
 3.21471345 3.57748639 3.12149101 3.90099156 3.09159602 2.30235416
 2.2372307  2.32496472 3.8379132  3.86205292 1.86756852 2.36094093
 1.16280749 1.15794601 1.13694113 1.1356359  1.14616902 1.16136809
 1.13676299 1.143786  ], functional 1.0079226526768543 , FOC condition 0.004536839383738703
Step [2.94985096 3.9997552  3.80520968 3.57068126 3.41247608 3.95221377
 3.45291658 3.71184015 3.96911656 3.86015107 2.68894435 3.81808503
 3.24260295 3.55018299 3.16248035 3.79756147 3.10829062 2.27862566
 2.23958998 2.32449839 3.8347419  3.84291184 1.85585338 2.32778018
 1.14012867 1.13426654 1.10178988 1.09979387 1.11306772 1.13768148
 1.0978433  1.10921577], functional 1.007732214931021 , FOC condition 0.00438678664379594
Step [2.93379059 3.9784019  3.74826587 3.50991061 3.26951895 3.89533983
 3.42012163 3.68158769 3.93459465 3.80457914 2.66912269 3.7999124
 3.21258711 3.53984696 3.12665191 3.74809248 3.09344084 2.2781609
 2.21916392 2.30509345 3.82192688 3.83575459 1.85269444 2.3322419
 1.13126707 1.12541816 1.08885765 1.08661099 1.10011991 1.12842207
 1.08261968 1.0956961 ], functional 1.0076492560073311 , FOC condition 0.004287153675274683
Step [2.91481155 3.95518185 3.67693913 3.50649193 3.20834011 3.82566842
 3.3755822  3.64139508 3.89037758 3.77708545 2.65107096 3.80257458
 3.17311988 3.53425405 3.07789279 3.72514068 3.07328411 2.28278198
 2.19591783 2.28359671 3.80836278 3.83195127 1.85172565 2.3444062
 1.12686808 1.12131136 1.08311475 1.08075583 1.09372948 1.12384934
 1.07511383 1.08903004], functional 1.0075873980335834 , FOC condition 0.004218421637365933
Step [2.89341902 3.92938233 3.59863671 3.53656924 3.17357564 3.74842756
 3.32835953 3.59838065 3.84231506 3.7661249  2.62801768 3.81669564
 3.13071637 3.52456299 3.02631818 3.70788925 3.05190952 2.28532925
 2.16930881 2.25867995 3.79232892 3.82533562 1.84924671 2.35460431
 1.12036851 1.11515793 1.07467391 1.07214214 1.08438238 1.11714674
 1.06415105 1.07928924], functional 1.007491456297609 , FOC condition 0.00414496702314961
Step [2.85689197 3.88503591 3.47415194 3.6410505  3.14173925 3.62220122
 3.26087177 3.53502939 3.76807004 3.78089421 2.57664126 3.85685742
 3.06746993 3.493052   2.95308166 3.67967072 3.02134685 2.27794266
 2.12201659 2.21304446 3.76157898 3.80368258 1.83885014 2.35647747
 1.10043907 1.0956508  1.04772464 1.0446294  1.05583018 1.09665411
 1.03068038 1.049543  ], functional 1.0072439070024297 , FOC condition 0.004007460964511479
Step [2.81239216 3.82990691 3.34476252 3.87412463 3.14497505 3.48210001
 3.21042346 3.48225083 3.69652473 3.86819901 2.4850058  3.93656151
 3.01255777 3.41850101 2.89968869 3.64147566 2.99846444 2.24058494
 2.05991975 2.14998623 3.71596561 3.75226946 1.81128439 2.32119673
 1.05479398 1.05000392 1.         1.         1.         1.0498018
 1.         1.        ], functional 1.0067350652089757 , FOC condition 0.0038152718263851715
Step [2.76073841 3.76110751 3.25895389 4.         3.16817382 3.35901146
 3.24375574 3.49156295 3.66815251 4.         2.29458476 4.
 3.01285251 3.22737518 2.94128465 3.55672833 3.01342945 2.11521736
 1.97486953 2.0552017  3.63940803 3.62015132 1.73617297 2.17158228
 1.         1.         1.00009127 1.00007625 1.00024027 1.
 1.00025955 1.00025946], functional 1.0054670527170972 , FOC condition 0.00343234386014862
Step [2.61501152 3.55778057 3.19000276 4.         3.48974844 3.11809893
 3.58488356 3.70760954 3.73519307 4.         1.53156107 4.
 3.1860359  2.4070987  3.33744183 3.27646792 3.16741393 1.54112843
 1.7003984  1.73009353 3.36028341 3.05298239 1.40853306 1.45749962
 1.00031212 1.000152   1.12217666 1.11754747 1.13821326 1.00033076
 1.10206634 1.12922911], functional 1.0017730742259072 , FOC condition 0.0022554136931573036
Step [2.61170168 3.54780932 3.34133092 4.         3.86332293 3.20651796
 3.8108758  3.88012993 3.86671203 4.         1.31491723 4.
 3.34241896 2.14037315 3.5930007  3.27803292 3.26979564 1.33354521
 1.66407378 1.67214651 3.29855655 2.86872954 1.29910584 1.18359602
 1.06463586 1.06291705 1.2        1.2        1.2        1.06446453
 1.2        1.2       ], functional 1.0008782734782935 , FOC condition 0.001648495772688162
Step [2.65227487 3.5975162  3.52980833 4.         4.         3.37749452
 3.95761648 4.         3.99206099 4.         1.30657058 4.
 3.46317526 2.09405926 3.75585726 3.33719391 3.33658658 1.27802608
 1.70738562 1.70687997 3.3150987  2.83699843 1.27751157 1.09713251
 1.12230502 1.11828652 1.2        1.2        1.2        1.12115947
 1.2        1.2       ], functional 1.0005946696574952 , FOC condition 0.0012478449305449754
Step [2.66907997 3.62088495 3.59466778 4.         4.         3.44015985
 3.99963229 4.         4.         4.         1.3203948  4.
 3.50040769 2.09646402 3.80249827 3.39010436 3.35602504 1.2719849
 1.72851094 1.72620835 3.32725518 2.8391147  1.27769103 1.08380477
 1.15159387 1.14646582 1.19994599 1.19993099 1.2        1.15002312
 1.2        1.2       ], functional 1.0005454490987407 , FOC condition 0.0011454243300983292
Step [2.677018   3.63637243 3.6314374  3.99999351 3.99999196 3.47343896
 4.         4.         4.         4.         1.3190493  4.
 3.52489196 2.08796111 3.83539843 3.47335113 3.36981695 1.26162859
 1.73846799 1.73447019 3.33182368 2.83415521 1.27431589 1.06762208
 1.18691517 1.18058236 1.2        1.2        1.2        1.18496056
 1.2        1.2       ], functional 1.0004995671652521 , FOC condition 0.0010791899739817095
Step [2.6749796  3.6472205  3.64321932 4.         4.         3.47762644
 3.99999514 3.99999515 4.         4.         1.29210543 4.
 3.54241808 2.05675163 3.86447682 3.64354048 3.38218814 1.23829687
 1.73573905 1.72924849 3.32649431 2.81471717 1.26315006 1.03750978
 1.2        1.2        1.19988047 1.19986547 1.2        1.2
 1.19999453 1.19999453], functional 1.0004184395613769 , FOC condition 0.0009959874235320604
Step [2.65873173 3.65535905 3.60749544 3.99997492 3.99997118 3.43299025
 3.96169583 3.97955308 4.         4.         1.2442969  3.9999998
 3.53876182 2.01277253 3.86961944 3.97658221 3.38533226 1.21187659
 1.71819586 1.70965207 3.31217186 2.78869511 1.24929972 1.0079591
 1.19996956 1.19980945 1.1991606  1.19926295 1.19999346 1.19999347
 1.2        1.19979265], functional 1.0003340008694575 , FOC condition 0.0009072085057817182
Step [2.65045534 3.65048485 3.57537599 4.         3.99245773 3.40185606
 3.94371258 3.97105035 4.         4.         1.23780236 4.
 3.52155602 2.01234536 3.84790669 4.         3.37673635 1.21555736
 1.70974985 1.70206986 3.30790572 2.78927013 1.25030841 1.01547561
 1.18036278 1.18063922 1.1949107  1.19504966 1.19610075 1.18057102
 1.19999057 1.19600168], functional 1.0003211283543316 , FOC condition 0.0008989837648430708
Step [2.64251319 3.64952509 3.54339883 3.99998852 3.97248033 3.37114719
 3.9251351  3.96243306 4.         4.         1.23305539 4.
 3.50478153 2.01409583 3.82619063 3.99996966 3.36849224 1.22087117
 1.70314045 1.69641188 3.30529193 2.79200697 1.25265932 1.02501432
 1.15551189 1.15617966 1.18490851 1.18507878 1.18684221 1.15589227
 1.19593374 1.18695848], functional 1.0003127486614987 , FOC condition 0.0009080233311366375
Step [2.64147925 3.6544822  3.5386041  3.99883086 3.95978372 3.3665982
 3.9208524  3.96051418 4.         4.         1.23324674 4.
 3.50316425 2.01574137 3.82367578 4.         3.36802066 1.22278993
 1.70411923 1.69755613 3.30662064 2.79428288 1.25421897 1.02784136
 1.14789547 1.14841656 1.17817735 1.1783302  1.18071766 1.14825686
 1.19188047 1.18097728], functional 1.0003092539138734 , FOC condition 0.0009092790830675587
Step [2.64016191 3.68061434 3.53353106 4.         3.92950407 3.36080466
 3.91082191 3.95611435 4.         4.         1.23209756 4.
 3.5068057  2.01769935 3.8273351  3.99998687 3.37202839 1.2255714
 1.71186127 1.70520311 3.31356564 2.80075976 1.25876409 1.03173397
 1.12963395 1.12882815 1.15379396 1.1539149  1.15874848 1.12975992
 1.1774571  1.15979914], functional 1.0002967737020991 , FOC condition 0.000910666108543633
Step [2.64027897 3.72085402 3.53687894 4.         3.91744807 3.36172558
 3.902192   3.95205751 4.         4.         1.22831595 4.
 3.51947562 2.01615998 3.84289582 4.         3.38206951 1.2252175
 1.72509169 1.71769215 3.324061   2.80717408 1.26344196 1.0308949
 1.11873064 1.11523429 1.12698167 1.12704013 1.13527852 1.11840484
 1.1630234  1.13752838], functional 1.0002807365355337 , FOC condition 0.0009033060886072953
Step [2.64040715 3.79900306 3.54677512 4.         3.94122086 3.36543741
 3.88732639 3.94343137 4.         4.         1.21595085 4.
 3.54782657 2.00709999 3.8791053  3.99999759 3.40406112 1.21983074
 1.75019191 1.74085065 3.34321909 2.81556466 1.2701146  1.02303773
 1.11582552 1.10611621 1.08937444 1.08924644 1.10405865 1.11457559
 1.14703431 1.10861374], functional 1.0002520062354023 , FOC condition 0.0008705053963003724
Step [2.63841279 3.88499282 3.55335397 4.         4.         3.36384324
 3.86853783 3.92963563 4.         4.         1.19544192 4.
 3.57917655 1.99077624 3.92037659 4.         3.42913967 1.21001256
 1.77572202 1.76391216 3.36246431 2.82107483 1.27544795 1.00984988
 1.12972428 1.11198441 1.06530289 1.06476801 1.08745098 1.12751074
 1.14476437 1.09435192], functional 1.0002216407815006 , FOC condition 0.0008035410377435531
Step [2.63192325 3.95669649 3.54481561 4.         4.         3.34708045
 3.8457856  3.9098808  4.         4.         1.16835321 4.
 3.60118578 1.96967683 3.95095112 3.99998798 3.44909859 1.1984075
 1.79284936 1.77881132 3.37570192 2.82188169 1.27811239 1.
 1.15473378 1.12905327 1.06473187 1.06349304 1.09423412 1.15194923
 1.1611405  1.10268691], functional 1.0001912528309274 , FOC condition 0.0007160579817427715
Step [2.61171364 4.         3.49894797 4.         4.         3.28734436
 3.80866009 3.87671274 4.         4.         1.10948237 4.
 3.61879397 1.92474229 3.98004396 3.96375485 3.47206483 1.17556034
 1.80454763 1.78728549 3.38581527 2.81393654 1.27735739 1.00005814
 1.19125473 1.15382776 1.08775711 1.0853172  1.12836202 1.18828342
 1.2        1.13900404], functional 1.0001464875607227 , FOC condition 0.0006019278658014021
Step [2.59061565 3.99984206 3.44125423 4.         4.         3.21847333
 3.76159502 3.83630723 4.         4.         1.0607942  4.
 3.63103654 1.89496921 3.99861968 3.92133913 3.49276771 1.16549301
 1.82390337 1.80445933 3.40430423 2.82032588 1.28564302 1.01735537
 1.2        1.16187728 1.09981092 1.0960383  1.15359527 1.2
 1.2        1.16684466], functional 1.00012120998234 , FOC condition 0.0005363877504749168
Step [2.58035197 3.95493483 3.40979433 4.         4.         3.18309716
 3.74928375 3.82049656 4.         4.         1.04155414 4.
 3.63212278 1.88551076 4.         3.90662073 3.49939058 1.16439347
 1.83182137 1.81182399 3.412703   2.82569848 1.29088531 1.03558724
 1.2        1.16149048 1.11651608 1.11192491 1.17664375 1.2
 1.2        1.1905883 ], functional 1.0001067662532679 , FOC condition 0.0004967144265222332
Step [2.57301744 3.87146932 3.38466924 4.         4.         3.15573973
 3.75754766 3.81517693 4.         4.         1.03120244 4.
 3.63371767 1.884188   4.         3.90144649 3.50532631 1.16819863
 1.84286306 1.82270087 3.42372106 2.83590303 1.29872714 1.06188943
 1.2        1.14871314 1.13601166 1.13040336 1.2        1.2
 1.2        1.2       ], functional 1.0000890778661957 , FOC condition 0.000445644884399364
Step [2.5703005  3.78942833 3.37684576 4.         4.         3.14528874
 3.78966247 3.82552305 4.         4.         1.02530314 4.
 3.64497582 1.88431667 4.         3.90794731 3.51623256 1.17096785
 1.85967565 1.83892441 3.43815121 2.84715386 1.30690428 1.08205383
 1.1999981  1.12010096 1.14438194 1.13769494 1.2        1.2
 1.2        1.2       ], functional 1.0000714050084105 , FOC condition 0.00038938878119646223
Step [2.57067507 3.72862058 3.3848306  4.         4.         3.14820014
 3.84382941 3.85112355 4.         4.         1.01681701 4.
 3.67096165 1.87987302 4.         3.92562655 3.53660907 1.16908088
 1.88527131 1.86293519 3.45815954 2.85841634 1.31526539 1.09124878
 1.19332589 1.0731761  1.13686562 1.12893438 1.2        1.2
 1.2        1.2       ], functional 1.0000533272487642 , FOC condition 0.0003237721831371112
Step [2.57295268 3.72992272 3.40103646 4.         4.         3.15930956
 3.89016382 3.87891069 4.         4.         1.00879646 4.
 3.69775361 1.87282096 4.         3.94332178 3.55614141 1.16384582
 1.90697965 1.88288896 3.47413029 2.86464271 1.32013544 1.08459559
 1.18089502 1.02865474 1.11468929 1.10597808 1.2        1.2
 1.2        1.2       ], functional 1.0000414556047585 , FOC condition 0.00027694382400120216
Step [2.57463389 3.76834282 3.41090913 4.         4.         3.16695023
 3.91081329 3.89671502 4.         4.         1.00566326 4.
 3.71001797 1.86918447 4.         3.9523988  3.56462601 1.16069289
 1.91566254 1.89074943 3.48019422 2.86612453 1.32139446 1.07361218
 1.16957037 1.00286849 1.09457467 1.08570263 1.2        1.2
 1.2        1.2       ], functional 1.0000360349223136 , FOC condition 0.00025796671173937224
Step [2.57486343 3.80149242 3.41084769 4.         4.         3.16731635
 3.91530814 3.90590379 4.         4.         1.00706265 4.
 3.70883275 1.8704267  4.         3.95432017 3.56363802 1.1614825
 1.91494342 1.89015543 3.47971307 2.86634412 1.32145611 1.06822933
 1.16331974 1.         1.08574504 1.07696794 1.2        1.2
 1.2        1.2       ], functional 1.0000328281483948 , FOC condition 0.0002479012769624079
Step [2.57259338 3.84789113 3.39905686 4.         4.         3.15679117
 3.93534919 3.93262571 4.         4.         1.00903059 4.
 3.70214104 1.87524797 4.         3.95722194 3.56016693 1.16644279
 1.91421169 1.89001261 3.4804615  2.87042439 1.32418101 1.06546061
 1.14759438 1.00006132 1.07244363 1.06357261 1.2        1.2
 1.2        1.2       ], functional 1.0000264248834643 , FOC condition 0.0002270648842667528
Step [2.56785816 3.88182186 3.3744881  4.         4.         3.13535185
 3.95798554 3.96458628 4.         4.         1.01320631 4.
 3.68461687 1.88423998 4.         3.95603086 3.54993171 1.17562171
 1.90781598 1.8849786  3.47791323 2.87553818 1.3274877  1.0697302
 1.13420891 1.01465245 1.06943318 1.06039494 1.2        1.2
 1.2        1.2       ], functional 1.000019550416067 , FOC condition 0.0001977564152681818
Step [2.56155317 3.88629429 3.3438913  4.         4.         3.10795091
 3.98360278 3.99622511 4.         4.         1.01600746 4.
 3.66458317 1.89324777 4.         3.95213668 3.53868273 1.18563503
 1.90068455 1.87933809 3.47524177 2.88125893 1.33132952 1.08098864
 1.12950561 1.03841097 1.07917924 1.06972218 1.2        1.2
 1.2        1.2       ], functional 1.0000137154721092 , FOC condition 0.00015788163485301764
Step [2.55770421 3.86660391 3.32810123 4.         4.         3.09266624
 3.99902281 4.         4.         4.         1.01391007 4.
 3.65768014 1.89489219 4.         3.94921305 3.5357481  1.1889579
 1.89927083 1.87836141 3.47548699 2.88397719 1.33342053 1.08976855
 1.13681458 1.05551335 1.09295476 1.08301487 1.2        1.2
 1.2        1.2       ], functional 1.0000111278334731 , FOC condition 0.00012842287768295452
Step [2.55656595 3.85158446 3.3261453  4.         4.         3.08947966
 4.         4.         4.         4.         1.00967948 4.
 3.66075541 1.89173934 4.         3.94863082 3.5386626  1.18731218
 1.90167584 1.88044441 3.47737383 2.88406823 1.33382387 1.09170588
 1.14674934 1.06308048 1.10111081 1.09080534 1.2        1.2
 1.2        1.2       ], functional 1.0000103071188007 , FOC condition 0.00011574944792697484
Step [2.55650712 3.8480796  3.32844436 4.         4.         3.09048166
 4.         4.         4.         4.         1.00624471 4.
 3.66549392 1.88834311 4.         3.94893268 3.54219985 1.18489346
 1.90431489 1.88266415 3.47908976 2.88343638 1.3336573  1.09007807
 1.1540282  1.06570036 1.10368127 1.09316166 1.2        1.2
 1.2        1.2       ], functional 1.0000100055220782 , FOC condition 0.00011143588471502451
Step [2.55654291 3.84973383 3.33065345 4.         4.         3.09160609
 4.         4.         4.         4.         1.00346135 4.
 3.66957467 1.88552598 4.         3.94926242 3.5451989  1.18284218
 1.90650733 1.88450112 3.48048924 2.88284496 1.33347367 1.08736466
 1.16054046 1.06711764 1.10418448 1.09348936 1.2        1.2
 1.2        1.2       ], functional 1.0000097706997348 , FOC condition 0.00010884466303095924
Step [2.55648081 3.85421879 3.33217392 4.         4.         3.09215383
 4.         4.         4.         4.         1.00092198 4.
 3.67315049 1.88310172 4.         3.9495236  3.54788744 1.18113789
 1.90845927 1.88614368 3.48177027 2.88239455 1.33338375 1.08337256
 1.16877736 1.06771915 1.10349529 1.09258112 1.2        1.2
 1.2        1.2       ], functional 1.0000094330071794 , FOC condition 0.00010570018426409833
Step [2.55620812 3.86154414 3.33234787 4.         4.         3.09149666
 4.         4.         4.         4.         1.         4.
 3.67605707 1.88134273 4.         3.94964121 3.55022589 1.18006104
 1.91015497 1.88759836 3.48298014 2.88225909 1.33352712 1.07640673
 1.18277654 1.06620676 1.10104662 1.08975362 1.2        1.2
 1.2        1.2       ], functional 1.0000087448510075 , FOC condition 9.925056530126818e-05
Step [2.5542662  3.86810977 3.32659938 4.         4.         3.08467033
 4.         4.         4.         4.         1.00002056 4.
 3.6771384  1.87845917 4.         3.94965436 3.55204175 1.17897326
 1.9105841  1.8878226  3.48352554 2.88166075 1.3336311  1.06401945
 1.2        1.05862989 1.09616487 1.08419069 1.2        1.2
 1.2        1.2       ], functional 1.0000076434934853 , FOC condition 8.556586643033855e-05
Step [2.55317026 3.8686996  3.3186168  4.         4.         3.07794361
 4.         4.         4.         4.         1.01021611 4.
 3.67175292 1.88328131 4.         3.94844983 3.54881722 1.18322479
 1.90827543 1.88603766 3.48253804 2.88362445 1.33495614 1.05221742
 1.19999916 1.04729569 1.09090088 1.07813287 1.2        1.2
 1.2        1.2       ], functional 1.00000627347232 , FOC condition 6.602937475171451e-05
Step [2.55295461 3.85804924 3.30847253 4.         4.         3.07109589
 4.         4.         4.         4.         1.03162865 4.
 3.66151261 1.89587603 4.         3.94674676 3.54181806 1.19295163
 1.90439871 1.88333269 3.48092305 2.88861198 1.33791684 1.03680874
 1.2        1.03801203 1.08951106 1.07530593 1.2        1.2
 1.2        1.2       ], functional 1.0000050697897676 , FOC condition 4.6350326896217535e-05
Step [2.55350238 3.84980128 3.30749226 4.         4.         3.0711906
 4.         4.         4.         4.         1.03821098 4.
 3.65914167 1.90013356 4.         3.94672155 3.53993526 1.1959247
 1.90359748 1.88287155 3.48059791 2.89020376 1.33879042 1.03347887
 1.2        1.03938402 1.0922808  1.07760549 1.2        1.2
 1.2        1.2       ], functional 1.0000048741375003 , FOC condition 4.0178446281126705e-05
Step [2.55380998 3.84539162 3.30794747 4.         4.         3.07175924
 4.         4.         4.         4.         1.040169   4.
 3.65951564 1.90109825 4.         3.94690984 3.54011718 1.19654041
 1.9039067  1.88321062 3.48085075 2.89062864 1.33906768 1.03067918
 1.2        1.04155107 1.09449222 1.0794981  1.2        1.2
 1.2        1.2       ], functional 1.000004790084798 , FOC condition 3.664728931413571e-05
Step [2.55391958 3.84360949 3.30855081 4.         4.         3.07199197
 4.         4.         4.         4.         1.04069677 4.
 3.66136643 1.90077587 4.         3.94717551 3.54149278 1.19632607
 1.90501117 1.88420247 3.48164582 2.89079805 1.33930154 1.02606188
 1.2        1.04403276 1.09629731 1.08089103 1.2        1.2
 1.2        1.2       ], functional 1.000004713777725 , FOC condition 3.346765220031413e-05
Step [2.55379184 3.84545111 3.30876073 4.         4.         3.07162105
 4.         4.         4.         4.         1.04008819 4.
 3.66356753 1.89974669 4.         3.94739313 3.54323936 1.19570838
 1.90634973 1.88537395 3.48262349 2.89084478 1.33951303 1.02146334
 1.2        1.04568508 1.0968871  1.08112934 1.2        1.2
 1.2        1.2       ], functional 1.0000046700257597 , FOC condition 3.169355257685756e-05
Step [2.55366021 3.84771911 3.30860474 4.         4.         3.07122214
 4.         4.         4.         4.         1.03947162 4.
 3.66433219 1.89924468 4.         3.94744893 3.5438896  1.19543138
 1.90684711 1.88580583 3.48300371 2.8908599  1.33960395 1.02001348
 1.2        1.04582288 1.09659541 1.08074971 1.2        1.2
 1.2        1.2       ], functional 1.0000046602304966 , FOC condition 3.124904982592455e-05
Step [2.55361246 3.84896844 3.30848549 4.         4.         3.07103898
 4.         4.         4.         4.         1.03912718 4.
 3.66451491 1.89914288 4.         3.94746213 3.54405674 1.19539029
 1.90698476 1.88592872 3.48312147 2.89089576 1.3396585  1.01968203
 1.2        1.0456823  1.09643248 1.08057352 1.2        1.2
 1.2        1.2       ], functional 1.00000465553106 , FOC condition 3.104076451312042e-05
Step [2.55357438 3.85118363 3.30827486 4.         4.         3.07076615
 4.         4.         4.         4.         1.03838275 4.
 3.66471638 1.89917364 4.         3.94747766 3.54424268 1.19545152
 1.9071427  1.88607767 3.48328032 2.89100584 1.33979151 1.01921517
 1.2        1.0451998  1.09635791 1.08048313 1.2        1.2
 1.2        1.2       ], functional 1.0000046431838203 , FOC condition 3.053326498759207e-05
Step [2.5536231  3.85413756 3.30802343 4.         4.         3.07050613
 4.         4.         4.         4.         1.03700037 4.
 3.66485578 1.89960903 4.         3.94749004 3.54435487 1.19578109
 1.90722794 1.88617784 3.48342667 2.8912386  1.34005283 1.01855595
 1.2        1.04404691 1.09677798 1.08087841 1.2        1.2
 1.2        1.2       ], functional 1.000004616948961 , FOC condition 2.9490265827561698e-05
Step [2.55390106 3.85719013 3.30783662 4.         4.         3.0704682
 4.         4.         4.         4.         1.03460723 4.
 3.66474664 1.90094143 4.         3.94748432 3.54419197 1.19667507
 1.90704136 1.88606508 3.48343691 2.8916666  1.34051637 1.01769427
 1.2        1.04165289 1.09837767 1.08243952 1.2        1.2
 1.2        1.2       ], functional 1.0000045680492176 , FOC condition 2.75511699832847e-05
Step [2.55446546 3.85774732 3.30796278 4.         4.         3.07097405
 4.         4.         4.         4.         1.03194286 4.
 3.6641641  1.90317431 4.         3.94744413 3.54353955 1.19808593
 1.90638481 1.88555319 3.48311969 2.89216386 1.34103955 1.0171005
 1.2        1.03851244 1.10121719 1.08524363 1.2        1.2
 1.2        1.2       ], functional 1.0000045103441741 , FOC condition 2.527687797709599e-05
Step [2.5550236  3.85492676 3.30837797 4.         4.         3.07181065
 4.         4.         4.         4.         1.03057178 4.
 3.6633703  1.9051078  4.         3.94739153 3.54270085 1.1992454
 1.90556266 1.88487151 3.48260125 2.89243353 1.34131152 1.01719094
 1.2        1.03650448 1.10364468 1.0876644  1.2        1.2
 1.2        1.2       ], functional 1.0000044727953308 , FOC condition 2.388704107332823e-05
Step [2.55529309 3.8518522  3.30871314 4.         4.         3.07237109
 4.         4.         4.         4.         1.03049783 4.
 3.66288119 1.90591181 4.         3.94736553 3.54220194 1.19969365
 1.90507843 1.88445404 3.48225086 2.89245637 1.34132719 1.01756315
 1.2        1.03624008 1.10443169 1.08846525 1.2        1.2
 1.2        1.2       ], functional 1.0000044567916722 , FOC condition 2.3312082841394094e-05
Step [2.55545005 3.84950166 3.30894139 4.         4.         3.07273097
 4.         4.         4.         4.         1.03057142 4.
 3.66259001 1.90634494 4.         3.94736568 3.54190352 1.1999257
 1.90478709 1.88420014 3.48203361 2.89244809 1.3413159  1.01785155
 1.2        1.03662576 1.10444373 1.08849325 1.2        1.2
 1.2        1.2       ], functional 1.0000044439749418 , FOC condition 2.2764606607133286e-05
Step [2.55571578 3.84636127 3.30924167 4.         4.         3.07322554
 4.         4.         4.         4.         1.03024074 4.
 3.66222364 1.9071514  4.         3.94741359 3.5415041  1.20038548
 1.90438622 1.88385975 3.48176316 2.89251638 1.34139285 1.018081
 1.2        1.0376837  1.10389681 1.08796933 1.2        1.2
 1.2        1.2       ], functional 1.000004418475661 , FOC condition 2.15014718104361e-05
Step [2.55618926 3.84309234 3.30957201 4.         4.         3.07384576
 4.         4.         4.         4.         1.02863477 4.
 3.66182474 1.90876964 4.         3.94757564 3.54100741 1.20136704
 1.90386116 1.88343844 3.48148458 2.8928212  1.341739   1.01789823
 1.2        1.03966598 1.10239497 1.08649067 1.2        1.2
 1.2        1.2       ], functional 1.0000043730643466 , FOC condition 1.888726712192739e-05
Step [2.55681361 3.84200576 3.30974044 4.         4.         3.07432153
 4.         4.         4.         4.         1.02518741 4.
 3.66163618 1.91113949 4.         3.94788634 3.54063793 1.20287317
 1.90341989 1.88312838 3.48138539 2.89346304 1.34246886 1.01686905
 1.2        1.04216396 1.09996073 1.08406012 1.2        1.2
 1.2        1.2       ], functional 1.0000043174747395 , FOC condition 1.5000974357827288e-05
Step [2.55718778 3.8445413  3.30959303 4.         4.         3.07428122
 4.         4.         4.         4.         1.02185542 4.
 3.66186738 1.91277487 4.         3.94817183 3.54070583 1.20397124
 1.9034086  1.88318872 3.4815918  2.89407729 1.34316949 1.01548337
 1.2        1.04347712 1.09816223 1.08223564 1.2        1.2
 1.2        1.2       ], functional 1.0000042852568705 , FOC condition 1.2252639170716086e-05
Step [2.5571968  3.84718725 3.30939399 4.         4.         3.07401853
 4.         4.         4.         4.         1.02077213 4.
 3.66216339 1.91297745 4.         3.94826372 3.54095007 1.20414762
 1.90361484 1.88338985 3.48181251 2.89427191 1.34339736 1.01482493
 1.2        1.04334182 1.09787898 1.08192836 1.2        1.2
 1.2        1.2       ], functional 1.000004278335376 , FOC condition 1.1600274663739822e-05
Step [2.55714553 3.84794338 3.30932572 4.         4.         3.07390504
 4.         4.         4.         4.         1.0208064  4.
 3.66225937 1.91282092 4.         3.94826057 3.54104681 1.20405941
 1.90369731 1.88345929 3.48187197 2.89425848 1.34339165 1.01474533
 1.2        1.04307971 1.09802299 1.08206667 1.2        1.2
 1.2        1.2       ], functional 1.000004277716105 , FOC condition 1.154697137111139e-05
Step [2.55712505 3.84813371 3.30930244 4.         4.         3.07386345
 4.         4.         4.         4.         1.02087598 4.
 3.66229148 1.91274757 4.         3.94825343 3.54107939 1.20401473
 1.9037148  1.88347135 3.48188278 2.8942388  1.3433809  1.01474494
 1.2        1.0429708  1.09809402 1.08213761 1.2        1.2
 1.2        1.2       ], functional 1.000004277484957 , FOC condition 1.1528035844300852e-05
Step [2.5570833  3.84856951 3.30924267 4.         4.         3.07375055
 4.         4.         4.         4.         1.02106851 4.
 3.66239708 1.91257675 4.         3.94823384 3.54117495 1.20390784
 1.90373666 1.883479   3.4818995  2.89417566 1.34336418 1.01475993
 1.2        1.04270255 1.09826776 1.08231511 1.2        1.2
 1.2        1.2       ], functional 1.0000042766214652 , FOC condition 1.1451214727829612e-05
Step [2.55704879 3.84914404 3.30915426 4.         4.         3.07356927
 4.         4.         4.         4.         1.02135088 4.
 3.66261348 1.9123755  4.         3.94820701 3.54134867 1.20377577
 1.90372295 1.88344385 3.48190571 2.89406126 1.34337142 1.01480015
 1.2        1.0423437  1.09849425 1.08255536 1.2        1.2
 1.2        1.2       ], functional 1.0000042747344469 , FOC condition 1.127108306980657e-05
Step [2.55705338 3.85002627 3.30899622 4.         4.         3.0732082
 4.         4.         4.         4.         1.02184879 4.
 3.6631548  1.91213804 4.         3.9481653  3.54174403 1.20360126
 1.90358948 1.88327042 3.48187456 2.89380542 1.34346392 1.01491398
 1.2        1.04178998 1.09882984 1.08293558 1.2        1.2
 1.2        1.2       ], functional 1.0000042698803986 , FOC condition 1.0776196289245884e-05
Step [2.55720484 3.85101865 3.30876431 4.         4.         3.07259524
 4.         4.         4.         4.         1.0225683  4.
 3.66429347 1.91205307 4.         3.94811766 3.54251462 1.20347707
 1.90315654 1.88277477 3.48173773 2.89331597 1.34377435 1.01517434
 1.2        1.04116332 1.09917646 1.08339187 1.2        1.2
 1.2        1.2       ], functional 1.000004259655091 , FOC condition 9.628088001347168e-06
Step [2.55766575 3.85149545 3.30851235 4.         4.         3.07175578
 4.         4.         4.         4.         1.02333482 4.
 3.66624518 1.91249469 4.         3.94809302 3.54374881 1.20360819
 1.9022014  1.88174235 3.48140375 2.89254761 1.34447046 1.01565315
 1.2        1.04085316 1.09926288 1.08368871 1.2        1.2
 1.2        1.2       ], functional 1.000004242651674 , FOC condition 7.332860115456195e-06
Step [2.55836373 3.85053908 3.30843348 4.         4.         3.07116515
 4.         4.         4.         4.         1.02355409 4.
 3.66820192 1.91362423 4.         3.94813482 3.54488473 1.20414176
 1.90099724 1.88049606 3.48095428 2.89186146 1.34536012 1.01617554
 1.2        1.0414376  1.09875687 1.08342017 1.2        1.2
 1.2        1.2       ], functional 1.0000042262640698 , FOC condition 4.147902928831036e-06
Step [2.55881028 3.84888346 3.30857555 4.         4.         3.07121564
 4.         4.         4.         4.         1.02310619 4.
 3.66883151 1.91463204 4.         3.94821054 3.54515479 1.2046905
 1.90038172 1.87990013 3.48070423 2.89172182 1.3458263  1.01638926
 1.2        1.04246696 1.09803969 1.08280456 1.2        1.2
 1.2        1.2       ], functional 1.0000042194397833 , FOC condition 1.6118293861379756e-06
Step [2.55887212 3.84812592 3.30869703 4.         4.         3.07144534
 4.         4.         4.         4.         1.02274476 4.
 3.66860041 1.91491556 4.         3.94824638 3.54495867 1.20487122
 1.90037897 1.87992381 3.48069091 2.89185716 1.34583777 1.01636224
 1.2        1.04294093 1.09774278 1.08249619 1.2        1.2
 1.2        1.2       ], functional 1.0000042184693405 , FOC condition 7.638343053725049e-07
Converged: FOC = 7.638343053725049e-07
relative differences mu 7.382945977220575e-05 and J 9.70438742492543e-10
Computing only the initial FOC

________________FOM LOD BFGS_____________________


PG--LOD FOM solves: 
        Coarse LOD system solves:               242
        Local corrector solves:                 80
        Total local corrector system solves:    128000 (solves x patches x shape functions: 80 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               0
        Local corrector solves:                 0
        Total local corrector system solves:    0  (solves x patches x shape functions: 0 x 400 x 4)


TSRBLOD solves:
        TSRBLOD ROM solves:                     0
outer iterations:      79
total walltime:        722.97s
mu_error:  0.058187607757986565

________________TR TSRBLOD BFGS_____________________

initializing roms ...
preparing constants ... constant k finished late...constant j finished early...Initialization took 31.1949s
Extending bases... ... Stage 1 enrichment took 53.4338s
 ... total Stage 1 time is currently 84.6288s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 1 basis functions ...
residual reduction took 1.22602s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 1 basis functions ...
residual reduction took 1.2740s
 ... enrichment completed... length of two scale bases are (1, 1)
 ... construction took 12.0150s
 ... total Stage 2 time is currently 12.0151s
starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Starting value of the cost rom: 1.051511195593586
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
boundary criterium of the TR satisfied, so stopping the sub-problem solver
sub-problem took 28.880309272557497
enriching to check the sufficient decrease condition
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.3673591673489183, 3.30364422762996, 1.4596827205061125, 2.352647758841147, 1.9352581399506241, 1.718130703538762, 1.8621896380595515, 2.3064299169469495, 2.479333824855826, 2.8758159809017725, 2.3406140133309288, 3.291509323964155, 1.8762245204831365, 3.634076934148378, 1.4151432488561186, 3.2056656749054664, 2.389022043359584, 2.6206356360062038, 1.559287921114111, 1.7188720330718914, 3.4775023330111714, 3.9041503340747394, 1.9319699691749865, 2.9665876239751174], low_diffusion: [1.2, 1.2, 1.1252600945014664, 1.1156742756886773, 1.1632056252742997, 1.2, 1.179328798746494, 1.2]}
Extending bases... ... Stage 1 enrichment took 63.1589s
 ... total Stage 1 time is currently 147.7878s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 2 basis functions ...
residual reduction took 1.34538s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 2 basis functions ...
residual reduction took 1.1363s
 ... enrichment completed... length of two scale bases are (2, 2)
 ... construction took 15.7947s
 ... total Stage 2 time is currently 27.8098s
estimate is: [0.00044585]
k: 0 - j 5 - Cost Functional: 1.0325916749007555 - mu: {diffusion: [2.3673591673489183, 3.30364422762996, 1.4596827205061125, 2.352647758841147, 1.9352581399506241, 1.718130703538762, 1.8621896380595515, 2.3064299169469495, 2.479333824855826, 2.8758159809017725, 2.3406140133309288, 3.291509323964155, 1.8762245204831365, 3.634076934148378, 1.4151432488561186, 3.2056656749054664, 2.389022043359584, 2.6206356360062038, 1.559287921114111, 1.7188720330718914, 3.4775023330111714, 3.9041503340747394, 1.9319699691749865, 2.9665876239751174], low_diffusion: [1.2, 1.2, 1.1252600945014664, 1.1156742756886773, 1.1632056252742997, 1.2, 1.179328798746494, 1.2]}
First order critical condition: 0.011698378202910703
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
boundary criterium of the TR satisfied, so stopping the sub-problem solver
sub-problem took 10.916251153685153
enriching to check the sufficient decrease condition
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.75770095325707, 3.837730234473425, 3.0793224354253805, 3.8964198706731517, 3.6943665060820323, 3.182881029637625, 3.155107260535736, 3.417000544855179, 3.6209622867773104, 3.8558086542867627, 2.3397813982350586, 3.9999899157523235, 2.989111516884767, 3.3142580281870497, 2.877617224247938, 3.912121290071522, 3.007953461883833, 2.1908303406223086, 2.012868403258502, 2.0988045815989755, 3.6880413416470472, 3.7009079303024595, 1.7870182333740219, 2.2654721777626317], low_diffusion: [1.1999920536936182, 1.1998953752638986, 1.1998288827232164, 1.1998091887858775, 1.1999874590946211, 1.1999874593560593, 1.1999845407339973, 1.199984580590624]}
Extending bases... ... Stage 1 enrichment took 88.7084s
 ... total Stage 1 time is currently 236.4963s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 3 basis functions ...
residual reduction took 1.37131s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 3 basis functions ...
residual reduction took 1.2055s
 ... enrichment completed... length of two scale bases are (3, 3)
 ... construction took 19.5306s
 ... total Stage 2 time is currently 47.3404s
estimate is: [0.00034372]
k: 1 - j 4 - Cost Functional: 1.0058803683854298 - mu: {diffusion: [2.75770095325707, 3.837730234473425, 3.0793224354253805, 3.8964198706731517, 3.6943665060820323, 3.182881029637625, 3.155107260535736, 3.417000544855179, 3.6209622867773104, 3.8558086542867627, 2.3397813982350586, 3.9999899157523235, 2.989111516884767, 3.3142580281870497, 2.877617224247938, 3.912121290071522, 3.007953461883833, 2.1908303406223086, 2.012868403258502, 2.0988045815989755, 3.6880413416470472, 3.7009079303024595, 1.7870182333740219, 2.2654721777626317], low_diffusion: [1.1999920536936182, 1.1998953752638986, 1.1998288827232164, 1.1998091887858775, 1.1999874590946211, 1.1999874593560593, 1.1999845407339973, 1.199984580590624]}
First order critical condition: 0.003674822871303305
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 7.756619555588947e-05, mu_diff = 4.511448776802295e-12, J_diff = 0.0 
relative differences mu 4.511448776802295e-12 and J 0.0
sub-problem took 81.87133101467043
enriching to check the sufficient decrease condition
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.5856042322053674, 3.8743961862385086, 3.3565759913532887, 4.0, 4.0, 3.1204966532865686, 4.0, 4.0, 4.0, 4.0, 1.058434052464252, 4.0, 3.6888823191800326, 1.937112860538193, 4.0, 3.967594148725366, 3.5468149033140195, 1.2081560066390309, 1.902954924337063, 1.882606454856232, 3.4793196584464643, 2.891031572763485, 1.3351482576654774, 1.0000145899171053], low_diffusion: [1.2, 1.085197406263374, 1.093836667000017, 1.0912606844332475, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 101.7270s
 ... total Stage 1 time is currently 338.2234s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 4 basis functions ...
residual reduction took 1.37309s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 4 basis functions ...
residual reduction took 1.6644s
 ... enrichment completed... length of two scale bases are (4, 4)
 ... construction took 23.4840s
 ... total Stage 2 time is currently 70.8245s
estimate is: [0.00049098]
k: 2 - j 22 - Cost Functional: 1.0000117816991745 - mu: {diffusion: [2.5856042322053674, 3.8743961862385086, 3.3565759913532887, 4.0, 4.0, 3.1204966532865686, 4.0, 4.0, 4.0, 4.0, 1.058434052464252, 4.0, 3.6888823191800326, 1.937112860538193, 4.0, 3.967594148725366, 3.5468149033140195, 1.2081560066390309, 1.902954924337063, 1.882606454856232, 3.4793196584464643, 2.891031572763485, 1.3351482576654774, 1.0000145899171053], low_diffusion: [1.2, 1.085197406263374, 1.093836667000017, 1.0912606844332475, 1.2, 1.2, 1.2, 1.2]}
enlarging the TR radius to 0.2
First order critical condition: 0.00015327866463681208
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 2.860325112469059e-06, mu_diff = 1.0373971541053596e-10, J_diff = 2.22043629283574e-16 
relative differences mu 1.0373971541053596e-10 and J 2.22043629283574e-16
sub-problem took 59.25248827133328
enriching to check the sufficient decrease condition
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.5581258473959183, 3.8471087304951608, 3.3066937559755476, 4.0, 4.0, 3.0695439475162702, 4.0, 4.0, 4.0, 4.0, 1.0216388725914072, 4.0, 3.6677264708768815, 1.9141570909891155, 4.0, 3.9503096148357537, 3.5450123882004494, 1.205009507916039, 1.9032226138040942, 1.882771687659427, 3.4853677247944566, 2.8965784937212917, 1.349698336829439, 1.019578346531018], low_diffusion: [1.197198086408131, 1.0391455822293734, 1.0934886350510107, 1.079037830511462, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 89.5401s
 ... total Stage 1 time is currently 427.7636s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 5 basis functions ...
residual reduction took 1.39643s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 5 basis functions ...
residual reduction took 1.2383s
 ... enrichment completed... length of two scale bases are (5, 5)
 ... construction took 26.5728s
 ... total Stage 2 time is currently 97.3974s
estimate is: [0.00044424]
k: 3 - j 12 - Cost Functional: 1.0000043373234009 - mu: {diffusion: [2.5581258473959183, 3.8471087304951608, 3.3066937559755476, 4.0, 4.0, 3.0695439475162702, 4.0, 4.0, 4.0, 4.0, 1.0216388725914072, 4.0, 3.6677264708768815, 1.9141570909891155, 4.0, 3.9503096148357537, 3.5450123882004494, 1.205009507916039, 1.9032226138040942, 1.882771687659427, 3.4853677247944566, 2.8965784937212917, 1.349698336829439, 1.019578346531018], low_diffusion: [1.197198086408131, 1.0391455822293734, 1.0934886350510107, 1.079037830511462, 1.2, 1.2, 1.2, 1.2]}
enlarging the TR radius to 0.4
First order critical condition: 1.8272887054615556e-05
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.3458323555218338e-06, mu_diff = 1.0972441936389504e-11, J_diff = 4.440873250398715e-16 
relative differences mu 1.0972441936389504e-11 and J 4.440873250398715e-16
sub-problem took 39.57605102285743
enriching to check the sufficient decrease condition
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.558979219473141, 3.84796826977941, 3.3087027651993455, 4.0, 4.0, 3.0714400582840575, 4.0, 4.0, 4.0, 4.0, 1.0224587432873085, 4.0, 3.6681999045608022, 1.914562871002061, 4.0, 3.948145057276678, 3.544509401616582, 1.2044564340518389, 1.899818012766405, 1.8793663342201525, 3.4806353185303043, 2.8918150262605145, 1.345679865601551, 1.0157506162009928], low_diffusion: [1.2, 1.0433013173268377, 1.0978250514233163, 1.0829322337540082, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 27.8523s
 ... total Stage 1 time is currently 455.6160s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 6 basis functions ...
residual reduction took 1.88470s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 6 basis functions ...
residual reduction took 1.2423s
 ... enrichment completed... length of two scale bases are (6, 6)
 ... construction took 30.1707s
 ... total Stage 2 time is currently 127.5681s
estimate is: [0.00043998]
k: 4 - j 3 - Cost Functional: 1.0000042199732488 - mu: {diffusion: [2.558979219473141, 3.84796826977941, 3.3087027651993455, 4.0, 4.0, 3.0714400582840575, 4.0, 4.0, 4.0, 4.0, 1.0224587432873085, 4.0, 3.6681999045608022, 1.914562871002061, 4.0, 3.948145057276678, 3.544509401616582, 1.2044564340518389, 1.899818012766405, 1.8793663342201525, 3.4806353185303043, 2.8918150262605145, 1.345679865601551, 1.0157506162009928], low_diffusion: [1.2, 1.0433013173268377, 1.0978250514233163, 1.0829322337540082, 1.2, 1.2, 1.2, 1.2]}
enlarging the TR radius to 0.8
First order critical condition: 2.186854684361884e-06
******************************* 

___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 5.740860364687164e-07, mu_diff = 1.9408069311364467e-11, J_diff = 0.0 
relative differences mu 1.9408069311364467e-11 and J 0.0
sub-problem took 25.385819326154888
enriching to check the sufficient decrease condition
checking global termination before expensive local enrichment
k: 5 - j 3 - Cost Functional: 1.000004217280672 - mu: {diffusion: [2.559036913704185, 3.8480269523228166, 3.3087771346697523, 4.0, 4.0, 3.071526442882393, 4.0, 4.0, 4.0, 4.0, 1.0226329293433858, 4.0, 3.6684329895835406, 1.9147841544602526, 4.0, 3.948291418329378, 3.5447799665215594, 1.204718770049385, 1.9003101101068405, 1.8798570666927528, 3.4809893126877323, 2.8921666639069974, 1.3460571021654473, 1.0161566795192059], low_diffusion: [1.2, 1.0432002706995336, 1.0977497773120695, 1.0827872010556248, 1.2, 1.2, 1.2, 1.2]}
First order critical condition: 6.037254052260874e-07
******************************* 


Stopping criteria fulfilled: FOC condition: 6.037254052260874e-07
Sub-problems took 245.88231s
Computing only the initial FOC

________________TR TSRBLOD BFGS_____________________

mu_error: 5.83e-02

PG--LOD FOM solves: 
        Coarse LOD system solves:               18
        Local corrector solves:                 12
        Total local corrector system solves:    19200 (solves x patches x shape functions: 12 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               42
        Local corrector solves:                 42
        Total local corrector system solves:    67200  (solves x patches x shape functions: 42 x 400 x 4)


TSRBLOD solves:
        TSRBLOD ROM solves:                     572
outer iterations:      6
total walltime:        901.76s
Outer iterations:      655.88s
Inner iterations:      245.88s
Stage 1 construction:  455.62s
Stage 2 construction:  127.57s
Speedup:               7.11

________________Relaxed TR TSRBLOD BFGS_____________________

initializing roms ...
preparing constants ... constant k finished late...constant j finished early...Initialization took 29.8725s
Extending bases... ... Stage 1 enrichment took 51.1472s
 ... total Stage 1 time is currently 81.0198s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 1 basis functions ...
residual reduction took 1.24225s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 1 basis functions ...
residual reduction took 1.0557s
 ... enrichment completed... length of two scale bases are (1, 1)
 ... construction took 12.0331s
 ... total Stage 2 time is currently 12.0331s
starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Starting value of the cost: 1.0515111955935863
******************************* 

Relaxing parameter: 1e+10
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 0.004186906848866465, mu_diff = 7.270140274165011e-13, J_diff = 2.191608710271401e-16 
relative differences mu 7.270140274165011e-13 and J 2.191608710271401e-16
sub-problem took 57.61511751078069
starting enrichment
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.8144332846763773, 3.8531182163430295, 3.229099423383792, 3.999999999999978, 3.842278689682349, 3.4159900040591755, 3.033906275104978, 3.347489651841737, 3.593876021481786, 3.8751945384564257, 2.655126742358285, 3.9998375065761005, 2.891142160205429, 3.627475337097778, 2.7018238082173607, 3.953833584973719, 2.9190861921591007, 2.4032480684637156, 2.09063826861622, 2.1975873460252076, 3.7664484483152774, 3.8984332391380923, 1.8981725203451891, 2.536518277774215], low_diffusion: [1.199889315791619, 1.198975522214902, 1.198691229160449, 1.1986396850308354, 1.19988757813248, 1.1998875788895926, 1.1998594679380854, 1.1998597621670053]}
Extending bases... ... Stage 1 enrichment took 85.0608s
 ... total Stage 1 time is currently 166.0808s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 2 basis functions ...
residual reduction took 1.43258s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 2 basis functions ...
residual reduction took 1.2404s
 ... enrichment completed... length of two scale bases are (2, 2)
 ... construction took 17.2680s
 ... total Stage 2 time is currently 29.3012s
estimate is: [6.81315663e-11]
k: 0 - j 6 - Cost Functional: 1.0131580691588602 - mu: {diffusion: [2.8144332846763773, 3.8531182163430295, 3.229099423383792, 3.999999999999978, 3.842278689682349, 3.4159900040591755, 3.033906275104978, 3.347489651841737, 3.593876021481786, 3.8751945384564257, 2.655126742358285, 3.9998375065761005, 2.891142160205429, 3.627475337097778, 2.7018238082173607, 3.953833584973719, 2.9190861921591007, 2.4032480684637156, 2.09063826861622, 2.1975873460252076, 3.7664484483152774, 3.8984332391380923, 1.8981725203451891, 2.536518277774215], low_diffusion: [1.199889315791619, 1.198975522214902, 1.198691229160449, 1.1986396850308354, 1.19988757813248, 1.1998875788895926, 1.1998594679380854, 1.1998597621670053]}
TR criterion: [1.28949301]
strong sufficient decrease condition fulfilled
First order critical condition: 0.0045131850765212115
******************************* 

Relaxing parameter: 1e+09
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.7225348995924226e-05, mu_diff = 6.229283135586513e-14, J_diff = 0.0 
relative differences mu 6.229283135586513e-14 and J 0.0
sub-problem took 122.44109207391739
starting enrichment
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.5670594102561655, 3.85563848015151, 3.3325675365247327, 4.0, 4.0, 3.097684279853641, 4.0, 4.0, 4.0, 4.0, 1.0267659325382044, 4.0, 3.667846729540123, 1.9182971597192724, 4.0, 3.9501487989794466, 3.537786333417833, 1.200725370133121, 1.8914232174341916, 1.8711997263379567, 3.4706571662569, 2.8829897116477707, 1.3318380784867492, 1.0074964704669087], low_diffusion: [1.2, 1.0539826484583146, 1.0907340632776719, 1.0789988701716162, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 120.1702s
 ... total Stage 1 time is currently 286.2510s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 3 basis functions ...
residual reduction took 1.36984s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 3 basis functions ...
residual reduction took 1.7817s
 ... enrichment completed... length of two scale bases are (3, 3)
 ... construction took 20.1700s
 ... total Stage 2 time is currently 49.4712s
estimate is: [6.21282878e-07]
k: 1 - j 35 - Cost Functional: 1.0001381678981727 - mu: {diffusion: [2.5670594102561655, 3.85563848015151, 3.3325675365247327, 4.0, 4.0, 3.097684279853641, 4.0, 4.0, 4.0, 4.0, 1.0267659325382044, 4.0, 3.667846729540123, 1.9182971597192724, 4.0, 3.9501487989794466, 3.537786333417833, 1.200725370133121, 1.8914232174341916, 1.8711997263379567, 3.4706571662569, 2.8829897116477707, 1.3318380784867492, 1.0074964704669087], low_diffusion: [1.2, 1.0539826484583146, 1.0907340632776719, 1.0789988701716162, 1.2, 1.2, 1.2, 1.2]}
TR criterion: [0.12587714]
strong sufficient decrease condition fulfilled
First order critical condition: 6.0253665809558366e-05
******************************* 

Relaxing parameter: 1e+08
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.0726815562440615e-06, mu_diff = 8.971506726975397e-11, J_diff = 0.0 
relative differences mu 8.971506726975397e-11 and J 0.0
sub-problem took 63.20557000674307
starting enrichment
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.558377080331921, 3.847356473899335, 3.3077316220540958, 4.0, 4.0, 3.070616396972491, 4.0, 4.0, 4.0, 4.0, 1.0216038266473646, 4.0, 3.6680117990042542, 1.9144712948616935, 4.0, 3.948687634407474, 3.545193262228225, 1.2052110152358528, 1.902087227269155, 1.8816372995664858, 3.4825863199950167, 2.8937989317507937, 1.3475896012721458, 1.0178697942812758], low_diffusion: [1.2, 1.041095518212618, 1.0963379672531104, 1.0814106527339715, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 91.6399s
 ... total Stage 1 time is currently 377.8910s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 4 basis functions ...
residual reduction took 1.38230s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 4 basis functions ...
residual reduction took 1.1785s
 ... enrichment completed... length of two scale bases are (4, 4)
 ... construction took 23.1717s
 ... total Stage 2 time is currently 72.6430s
estimate is: [3.12029139e-05]
k: 2 - j 17 - Cost Functional: 1.000004184727989 - mu: {diffusion: [2.558377080331921, 3.847356473899335, 3.3077316220540958, 4.0, 4.0, 3.070616396972491, 4.0, 4.0, 4.0, 4.0, 1.0216038266473646, 4.0, 3.6680117990042542, 1.9144712948616935, 4.0, 3.948687634407474, 3.545193262228225, 1.2052110152358528, 1.902087227269155, 1.8816372995664858, 3.4825863199950167, 2.8937989317507937, 1.3475896012721458, 1.0178697942812758], low_diffusion: [1.2, 1.041095518212618, 1.0963379672531104, 1.0814106527339715, 1.2, 1.2, 1.2, 1.2]}
TR criterion: [4.99562482e-05]
strong sufficient decrease condition fulfilled
First order critical condition: 7.4380352738372244e-06
******************************* 

Relaxing parameter: 1e+07
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 2.1866687907017733e-07, mu_diff = 2.1620919164331517e-12, J_diff = 2.220436658926719e-16 
relative differences mu 2.1620919164331517e-12 and J 2.220436658926719e-16
sub-problem took 46.68887364305556
starting enrichment
checking global termination before expensive local enrichment
k: 3 - j 5 - Cost Functional: 1.0000042290436684 - mu: {diffusion: [2.5590432586669003, 3.848032869789486, 3.308834594666757, 4.0, 4.0, 3.071603427457523, 4.0, 4.0, 4.0, 4.0, 1.022670191757845, 4.0, 3.6683814630440144, 1.914736500041833, 4.0, 3.948228092592518, 3.5447574787432554, 1.2046989291473518, 1.9001707892357282, 1.8797179031423077, 3.4808052164750687, 2.891983178272349, 1.3460158352624056, 1.0161582031686411], low_diffusion: [1.2, 1.0431736572883772, 1.0979194835829094, 1.0829069613994844, 1.2, 1.2, 1.2, 1.2]}
TR criterion: [1.12312749e-06]
strong sufficient decrease condition fulfilled
First order critical condition: 8.175289795339821e-07
******************************* 


Stopping criteria fulfilled: FOC condition: 8.175289795339821e-07
Sub-problems took 289.95069s
Computing only the initial FOC

________________Relaxed TR TSRBLOD BFGS_____________________

mu_error: 5.82e-02

PG--LOD FOM solves: 
        Coarse LOD system solves:               12
        Local corrector solves:                 8
        Total local corrector system solves:    12800 (solves x patches x shape functions: 8 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               20
        Local corrector solves:                 20
        Total local corrector system solves:    32000  (solves x patches x shape functions: 20 x 400 x 4)


TSRBLOD solves:
        TSRBLOD ROM solves:                     671
outer iterations:      4
total walltime:        788.62s
Outer iterations:      498.67s
Inner iterations:      289.95s
Stage 1 construction:  377.89s
Stage 2 construction:  72.64s
Speedup:               8.13

________________Relaxed TR TSRBLOD BFGS without estimation_____________________

initializing roms ...
preparing constants ... constant k finished late...constant j finished early...Initialization took 19.6234s
Extending bases... ... Stage 1 enrichment took 27.9928s
 ... total Stage 1 time is currently 47.6163s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 1 basis functions ...
residual reduction took 0.60979s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 1 basis functions ...
residual reduction took 0.5988s
 ... enrichment completed... length of two scale bases are (1, 1)
 ... construction took 8.9766s
 ... total Stage 2 time is currently 8.9766s
starting parameter {diffusion: [2.251066014107722, 3.1609734803264744, 1.0003431244520347, 1.9069977178955193, 1.440267672451339, 1.2770157843063934, 1.5587806341330128, 2.036682181129143, 2.19030242269201, 2.616450202010071, 2.2575835432098845, 3.0556585011902784, 1.6133567491945522, 3.6343523091728365, 1.0821627795937785, 3.011402530535207, 2.251914407101381, 2.676069485337255, 1.4211608157857012, 1.5943044672546365, 3.40223370602661, 3.9047847271581926, 1.9402725344777285, 3.0769678470079422], low_diffusion: [1.1752778304592075, 1.1789213327007695, 1.0170088422739556, 1.0078109566465765, 1.0339660839129137, 1.1756285006858826, 1.01966936676661, 1.0842215250010103]}
Starting value of the cost: 1.051511195593586
******************************* 

Relaxing parameter: 1e+10
skipping estimations entirely
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 0.004186909154989303, mu_diff = 1.4540457518587686e-12, J_diff = 6.574826042994685e-16 
relative differences mu 1.4540457518587686e-12 and J 6.574826042994685e-16
sub-problem took 0.5557425515726209
starting enrichment
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.8144327870240433, 3.8531176103146607, 3.2290974737776272, 3.999999999999956, 3.842276589998778, 3.415988125675706, 3.033905000714653, 3.3474885158383407, 3.593874800011075, 3.8751934388738736, 2.6551263658327837, 3.9998375056373403, 2.8911410550330565, 3.6274753131895845, 2.7018224130761785, 3.9538327597666187, 2.9190856188837424, 2.403248286314103, 2.0906376790615893, 2.1975868122006355, 3.766448124343028, 3.8984332270159507, 1.898172547368844, 2.5365187242050355], low_diffusion: [1.1998893152191228, 1.1989755223604355, 1.1986912254231334, 1.198639681061357, 1.1998875774831204, 1.1998875782402563, 1.1998594671263618, 1.1998597613569901]}
Extending bases... ... Stage 1 enrichment took 35.8741s
 ... total Stage 1 time is currently 83.4904s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 2 basis functions ...
residual reduction took 0.68973s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 2 basis functions ...
residual reduction took 0.7092s
 ... enrichment completed... length of two scale bases are (2, 2)
 ... construction took 13.0953s
 ... total Stage 2 time is currently 22.0720s
k: 0 - j 6 - Cost Functional: 1.0131580826915454 - mu: {diffusion: [2.8144327870240433, 3.8531176103146607, 3.2290974737776272, 3.999999999999956, 3.842276589998778, 3.415988125675706, 3.033905000714653, 3.3474885158383407, 3.593874800011075, 3.8751934388738736, 2.6551263658327837, 3.9998375056373403, 2.8911410550330565, 3.6274753131895845, 2.7018224130761785, 3.9538327597666187, 2.9190856188837424, 2.403248286314103, 2.0906376790615893, 2.1975868122006355, 3.766448124343028, 3.8984332270159507, 1.898172547368844, 2.5365187242050355], low_diffusion: [1.1998893152191228, 1.1989755223604355, 1.1986912254231334, 1.198639681061357, 1.1998875774831204, 1.1998875782402563, 1.1998594671263618, 1.1998597613569901]}
TR criterion: inf
strong sufficient decrease condition fulfilled
First order critical condition: 0.004513184308544653
******************************* 

Relaxing parameter: 1e+09
skipping estimations entirely
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.7225147483146106e-05, mu_diff = 9.968921662143641e-13, J_diff = 4.4402785965946056e-16 
relative differences mu 9.968921662143641e-13 and J 4.4402785965946056e-16
sub-problem took 2.698152626864612
starting enrichment
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.5670582851808144, 3.8556373725239617, 3.3325646972988974, 4.0, 4.0, 3.0976812293630966, 4.0, 4.0, 4.0, 4.0, 1.026765540853587, 4.0, 3.667846620283627, 1.9182968781307472, 4.0, 3.9501485621969357, 3.5377868932739975, 1.2007258042724698, 1.8914244053401943, 1.8712009037941637, 3.4706584765646737, 2.8829909757470626, 1.3318391013294217, 1.0074980494165886], low_diffusion: [1.2, 1.0539833867524653, 1.0907351438326496, 1.0789996354750317, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 48.9152s
 ... total Stage 1 time is currently 132.4057s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 3 basis functions ...
residual reduction took 0.71454s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 3 basis functions ...
residual reduction took 0.7029s
 ... enrichment completed... length of two scale bases are (3, 3)
 ... construction took 17.6880s
 ... total Stage 2 time is currently 39.7600s
k: 1 - j 35 - Cost Functional: 1.0001381674353698 - mu: {diffusion: [2.5670582851808144, 3.8556373725239617, 3.3325646972988974, 4.0, 4.0, 3.0976812293630966, 4.0, 4.0, 4.0, 4.0, 1.026765540853587, 4.0, 3.667846620283627, 1.9182968781307472, 4.0, 3.9501485621969357, 3.5377868932739975, 1.2007258042724698, 1.8914244053401943, 1.8712009037941637, 3.4706584765646737, 2.8829909757470626, 1.3318391013294217, 1.0074980494165886], low_diffusion: [1.2, 1.0539833867524653, 1.0907351438326496, 1.0789996354750317, 1.2, 1.2, 1.2, 1.2]}
TR criterion: inf
strong sufficient decrease condition fulfilled
First order critical condition: 6.024645379521776e-05
******************************* 

Relaxing parameter: 1e+08
skipping estimations entirely
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 1.0721540206929887e-06, mu_diff = 2.8035252683821996e-12, J_diff = 0.0 
relative differences mu 2.8035252683821996e-12 and J 0.0
sub-problem took 1.4608261808753014
starting enrichment
checking global termination before expensive local enrichment
enriching for mu: {diffusion: [2.5583771230317116, 3.847356522787084, 3.3077315889730907, 4.0, 4.0, 3.070616320821397, 4.0, 4.0, 4.0, 4.0, 1.0216039404663273, 4.0, 3.668011854169102, 1.9144712876585623, 4.0, 3.9486875742404397, 3.545193317174762, 1.205211024585347, 1.9020870955353602, 1.881637164638614, 3.4825862131315084, 2.893798806734229, 1.3475896040102746, 1.0178697360188584], low_diffusion: [1.2, 1.0410952221679135, 1.0963379072284043, 1.0814105376154441, 1.2, 1.2, 1.2, 1.2]}
Extending bases... ... Stage 1 enrichment took 42.9346s
 ... total Stage 1 time is currently 175.3404s
building_two_scale_model
building_two_scale_reductor ...
Constructing ROM ...Extending primal model with 4 basis functions ...
residual reduction took 0.73364s
building_two_scale_model
building_two_scale_reductor ...
Extending dual model with 4 basis functions ...
residual reduction took 0.7491s
 ... enrichment completed... length of two scale bases are (4, 4)
 ... construction took 20.8734s
 ... total Stage 2 time is currently 60.6335s
k: 2 - j 17 - Cost Functional: 1.00000418472877 - mu: {diffusion: [2.5583771230317116, 3.847356522787084, 3.3077315889730907, 4.0, 4.0, 3.070616320821397, 4.0, 4.0, 4.0, 4.0, 1.0216039404663273, 4.0, 3.668011854169102, 1.9144712876585623, 4.0, 3.9486875742404397, 3.545193317174762, 1.205211024585347, 1.9020870955353602, 1.881637164638614, 3.4825862131315084, 2.893798806734229, 1.3475896040102746, 1.0178697360188584], low_diffusion: [1.2, 1.0410952221679135, 1.0963379072284043, 1.0814105376154441, 1.2, 1.2, 1.2, 1.2]}
TR criterion: inf
strong sufficient decrease condition fulfilled
First order critical condition: 7.43782386753834e-06
******************************* 

Relaxing parameter: 1e+07
skipping estimations entirely
___ starting subproblem
Computing the approximate Cauchy point and then start the BFGS method
Subproblem converged: FOC = 2.1844554525330958e-07, mu_diff = 1.0799642195577128e-12, J_diff = 0.0 
relative differences mu 1.0799642195577128e-12 and J 0.0
sub-problem took 0.4883262375369668
starting enrichment
checking global termination before expensive local enrichment
k: 3 - j 5 - Cost Functional: 1.0000042290426578 - mu: {diffusion: [2.559043286810013, 3.8480328989807986, 3.3088346344551547, 4.0, 4.0, 3.071603458540773, 4.0, 4.0, 4.0, 4.0, 1.0226702442083704, 4.0, 3.668381489290879, 1.914736515678783, 4.0, 3.9482280795838913, 3.544757474231625, 1.2046989168926134, 1.9001707403977226, 1.8797178538222534, 3.480805169765677, 2.891983128379136, 1.3460157897360014, 1.016158146015462], low_diffusion: [1.2, 1.0431737383291484, 1.0979195673292192, 1.0829070360384148, 1.2, 1.2, 1.2, 1.2]}
TR criterion: inf
strong sufficient decrease condition fulfilled
First order critical condition: 8.177865231478797e-07
******************************* 


Stopping criteria fulfilled: FOC condition: 8.177865231478797e-07
Sub-problems took 5.20308s
Computing only the initial FOC

________________Relaxed TR TSRBLOD BFGS without estimation_____________________

mu_error: 5.82e-02

PG--LOD FOM solves: 
        Coarse LOD system solves:               12
        Local corrector solves:                 8
        Total local corrector system solves:    12800 (solves x patches x shape functions: 8 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               20
        Local corrector solves:                 20
        Total local corrector system solves:    32000  (solves x patches x shape functions: 20 x 400 x 4)


TSRBLOD solves:
        TSRBLOD ROM solves:                     311
outer iterations:      4
total walltime:        281.52s
Outer iterations:      276.32s
Inner iterations:      5.20s
Stage 1 construction:  175.34s
Stage 2 construction:  60.63s
Speedup:               22.78

#####################################################################################
#################################### SUMMARY ########################################
#####################################################################################

________________ FOM BFGS________________________

FEM solves:   163
RB solves:    0

mu_error :             9.08e-02
J_error  :             4.24e-06
FOC      :             9.36e-05

outer iterations:      52
total walltime:        6411.71s

_________________TR-RB NCD BFGS_____________________

FEM solves:   10
RB solves:    1067

mu_error :             1.01e-02
J_error  :             7.29e-08
FOC      :             1.51e-05

outer iterations:      3
total walltime:        862.68s
Outer iterations:      841.17s
Inner iterations:      21.51s
Speedup:               7.43

_________________Relaxed TR-RB BFGS_____________________

FEM solves:   8
RB solves:    1082

mu_error :             1.75e-02
J_error  :             2.45e-07
FOC      :             3.00e-05

outer iterations:      2
total walltime:        565.38s
Outer iterations:      542.24s
Inner iterations:      23.14s
Speedup:               11.34

_________________Relaxed TR-RB BFGS without estimation_____________________

FEM solves:   8
RB solves:    696

mu_error :             1.75e-02
J_error  :             2.45e-07
FOC      :             3.00e-05

outer iterations:      2
total walltime:        289.98s
Outer iterations:      267.89s
Inner iterations:      22.09s
Speedup:               22.11

________________FOM LOD BFGS_____________________

PG--LOD FOM solves: 
        Coarse LOD system solves:               242
        Local corrector solves:                 80
        Total local corrector system solves:    128000 (solves x patches x shape functions: 80 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               0
        Local corrector solves:                 0
        Total local corrector system solves:    0  (solves x patches x shape functions: 0 x 400 x 4)

TSRBLOD solves:
        TSRBLOD ROM solves:                     0

mu_error :             5.82e-02
J_error  :             4.22e-06
FOC      :             7.64e-07

outer iterations:      79
total walltime:        722.97s
Speedup:               8.87

________________TR-TSRBLOD BFGS_____________________

PG--LOD FOM solves: 
        Coarse LOD system solves:               18
        Local corrector solves:                 12
        Total local corrector system solves:    19200 (solves x patches x shape functions: 12 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               42
        Local corrector solves:                 42
        Total local corrector system solves:    67200  (solves x patches x shape functions: 42 x 400 x 4)

TSRBLOD solves:
        TSRBLOD ROM solves:                     572

mu_error:              5.83e-02
J_error :              4.22e-06
FOC     :              6.04e-07

outer iterations:      6
total walltime:        901.76s
Outer iterations:      655.88s
Inner iterations:      245.88s
Stage 1 construction:  455.62s
Stage 2 construction:  127.57s
Speedup:               7.11

________________Relaxed TR-TSRBLOD BFGS_____________________

PG--LOD FOM solves: 
        Coarse LOD system solves:               12
        Local corrector solves:                 8
        Total local corrector system solves:    12800 (solves x patches x shape functions: 8 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               20
        Local corrector solves:                 20
        Total local corrector system solves:    32000  (solves x patches x shape functions: 20 x 400 x 4)

TSRBLOD solves:
        TSRBLOD ROM solves:                     671

mu_error:              5.82e-02
J_error :              4.22e-06
FOC     :              8.18e-07

outer iterations:      4
total walltime:        788.62s
Outer iterations:      498.67s
Inner iterations:      289.95s
Stage 1 construction:  377.89s
Stage 2 construction:  72.64s
Speedup:               8.13

________________Relaxed TR-TSRBLOD BFGS without estimation_____________________

PG--LOD FOM solves: 
        Coarse LOD system solves:               12
        Local corrector solves:                 8
        Total local corrector system solves:    12800 (solves x patches x shape functions: 8 x 400 x 4)

RBLOD solves: 
        Coarse LOD system solves:               20
        Local corrector solves:                 20
        Total local corrector system solves:    32000  (solves x patches x shape functions: 20 x 400 x 4)

TSRBLOD solves:
        TSRBLOD ROM solves:                     311

mu_error:              5.82e-02
J_error :              4.22e-06
FOC     :              8.18e-07

outer iterations:      4
total walltime:        281.52s
Outer iterations:      276.32s
Inner iterations:      5.20s
Stage 1 construction:  175.34s
Stage 2 construction:  60.63s
Speedup:               22.78

Job 14692703 completed successfully!
